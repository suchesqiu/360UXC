<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../comps/Tree/Tree.js - UXC jquery components</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../uxc.png" title="UXC jquery components"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/.window.html">.window</a></li>
            
                <li><a href="../classes/UXC.alert.html">UXC.alert</a></li>
            
                <li><a href="../classes/UXC.Calendar.html">UXC.Calendar</a></li>
            
                <li><a href="../classes/UXC.confirm.html">UXC.confirm</a></li>
            
                <li><a href="../classes/UXC.Dialog.html">UXC.Dialog</a></li>
            
                <li><a href="../classes/UXC.Dialog.alert.html">UXC.Dialog.alert</a></li>
            
                <li><a href="../classes/UXC.Dialog.confirm.html">UXC.Dialog.confirm</a></li>
            
                <li><a href="../classes/UXC.Dialog.mask.html">UXC.Dialog.mask</a></li>
            
                <li><a href="../classes/UXC.Form.html">UXC.Form</a></li>
            
                <li><a href="../classes/UXC.hideAllPanel.html">UXC.hideAllPanel</a></li>
            
                <li><a href="../classes/UXC.hideAllPopup.html">UXC.hideAllPopup</a></li>
            
                <li><a href="../classes/UXC.LunarCalendar.html">UXC.LunarCalendar</a></li>
            
                <li><a href="../classes/UXC.LunarCalendar.Model.html">UXC.LunarCalendar.Model</a></li>
            
                <li><a href="../classes/UXC.LunarCalendar.View.html">UXC.LunarCalendar.View</a></li>
            
                <li><a href="../classes/UXC.Panel.html">UXC.Panel</a></li>
            
                <li><a href="../classes/UXC.Panel.Model.html">UXC.Panel.Model</a></li>
            
                <li><a href="../classes/UXC.Panel.View.html">UXC.Panel.View</a></li>
            
                <li><a href="../classes/UXC.Slider.html">UXC.Slider</a></li>
            
                <li><a href="../classes/UXC.Slider.Model.html">UXC.Slider.Model</a></li>
            
                <li><a href="../classes/UXC.Tab.html">UXC.Tab</a></li>
            
                <li><a href="../classes/UXC.Tab.Model.html">UXC.Tab.Model</a></li>
            
                <li><a href="../classes/UXC.Tab.View.html">UXC.Tab.View</a></li>
            
                <li><a href="../classes/UXC.Test.html">UXC.Test</a></li>
            
                <li><a href="../classes/UXC.Tips.html">UXC.Tips</a></li>
            
                <li><a href="../classes/UXC.Tips.Model.html">UXC.Tips.Model</a></li>
            
                <li><a href="../classes/UXC.Tips.View.html">UXC.Tips.View</a></li>
            
                <li><a href="../classes/UXC.Tree.html">UXC.Tree</a></li>
            
                <li><a href="../classes/UXC.Tree.Model.html">UXC.Tree.Model</a></li>
            
                <li><a href="../classes/UXC.Valid.html">UXC.Valid</a></li>
            
                <li><a href="../classes/window.jQuery.html">window.jQuery</a></li>
            
                <li><a href="../classes/window.UXC.html">window.UXC</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../comps/Tree/Tree.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
;( function( $ ){
    !window.UXC &amp;&amp; (window.UXC = { log:function(){} });
    window.Tree = UXC.Tree = Tree;
    /**
     * 树菜单类 UXC.Tree
     * &lt;p&gt;&lt;b&gt;requires&lt;/b&gt;: &lt;a href=&#x27;window.jQuery.html&#x27;&gt;jQuery&lt;/a&gt;, 
     * &lt;a href=&#x27;.window.html#method_printf&#x27;&gt;window.printf&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;&lt;a href=&#x27;https://github.com/suchesqiu/360UXC.git&#x27; target=&#x27;_blank&#x27;&gt;UXC Project Site&lt;/a&gt;
     * | &lt;a href=&#x27;http://uxc.btbtd.org/uxc_docs/classes/UXC.Tree.html&#x27; target=&#x27;_blank&#x27;&gt;API docs&lt;/a&gt;
     * | &lt;a href=&#x27;../../comps/Tree/_demo&#x27; target=&#x27;_blank&#x27;&gt;demo link&lt;/a&gt;&lt;/p&gt;
     * @namespace UXC
     * @class Tree
     * @constructor
     * @param   {selector}          _selector   树要显示的选择器
     * @param   {object}            _data       树菜单的数据
     * @version dev 0.1
     * @author  qiushaowei   &lt;suches@btbtd.org&gt; | 75 Team
     * @date    2013-06-29
     * @example
            &lt;link href=&#x27;../../../comps/Tree/res/default/style.css&#x27; rel=&#x27;stylesheet&#x27; /&gt;
            &lt;script src=&quot;../../../lib.js&quot;&gt;&lt;/script&gt;
            &lt;script&gt;
                UXC.use( &#x27;Tree&#x27; );
                $(document).ready( function(){
                    var treeData = {
                        data: {&quot;24&quot;:[[&quot;25&quot;,&quot;\u4e8c\u7ec4\u4e00\u961f&quot;],[&quot;26&quot;,&quot;\u4e8c\u7ec4\u4e8c\u961f&quot;],[&quot;27&quot;,&quot;\u4e8c\u7ec4\u4e09\u961f&quot;]],&quot;23&quot;:[[&quot;28&quot;,&quot;\u9500\u552e\u4e8c\u7ec4&quot;],[&quot;24&quot;,&quot;\u552e\u524d\u5ba1\u6838\u7ec4&quot;]]},
                        root: [&quot;23&quot;,&#x27;客户发展部&#x27;]
                    };
                    var _tree = new UXC.Tree( $(&#x27;#tree_box2&#x27;), treeData );
                        _tree.on(&#x27;RenderLabel&#x27;, function( _data ){
                            var _node = $(this);
                            _node.html( printf( &#x27;&lt;a href=&quot;javascript:&quot; dataid=&quot;{0}&quot;&gt;{1}&lt;/a&gt;&#x27;, _data[0], _data[1] ) );
                        });
                        _tree.on(&#x27;click&#x27;, function( _evt ){
                            var _p = $(this);
                            UXC.log( &#x27;tree click:&#x27;, _p.html(), _p.attr(&#x27;dataid&#x27;), _p.attr(&#x27;dataname&#x27;) );
                        });
                        _tree.init();
                        //_queryNode &amp;&amp; _tree.open( _queryNode );
                });
            &lt;/script&gt;
            &lt;div id=&quot;tree_box2&quot; class=&quot;tree_container&quot;&gt;&lt;/div&gt;
     */

    function Tree( _container, _data ){
        if( _container &amp;&amp; $(_container).length ){
            _container = $(_container);
            if( Tree.getInstance( _container ) ) return Tree.getInstance( _container );
            _container.data( &#x27;TreeIns&#x27;, this );
        }
        /**
         * 树的数据模型引用
         * @property    _model
         * @type    UXC.Tree.Model
         * @private
         */
        this._model = new Model( _container, _data );
        /**
         * 树的视图模型引用
         * @property    _view
         * @type    UXC.Tree.View
         * @private
         */
        this._view = new View( this._model );
    }
    /**
     * 从选择器获取 树的 实例, 如果实例有限, 加以判断可避免重复初始化
     * @method  getInstance
     * @param   {selector}      _selector
     * @static
     * @return  {UXC.Tree Instance|undefined}
     */
    Tree.getInstance = 
        function( _selector ){
            _selector = $(_selector);
            return _selector.data(&#x27;TreeIns&#x27;);
        };
    /**
     * 树的数据过滤函数
     * &lt;br /&gt; 如果树的初始数据格式不符合要求, 可通过该属性定义函数进行数据修正
     * @property    dataFilter
     * @type        function
     * @default     undefined
     * @static
     * @example
            UXC.Tree.dataFilter =
            function( _data ){
                var _r = {};

                if( _data ){
                    if( _data.root.length &gt; 2 ){
                        _data.root.shift();
                        _r.root = _data.root;
                     }
                    _r.data = {};
                    for( var k in _data.data ){
                        _r.data[ k ] = [];
                        for( var i = 0, j = _data.data[k].length; i &lt; j; i++ ){
                            if( _data.data[k][i].length &lt; 3 ) continue;
                            _data.data[k][i].shift();
                            _r.data[k].push( _data.data[k][i] );
                        }
                    }
                }
                return _r;
            };
     */
    Tree.dataFilter;
    
    Tree.prototype = {
        /**
         * 初始化树
         * &lt;br /&gt; 实例化树后, 需要显式调用该方法初始化树的可视状态
         * @method  init
         * @example
                var _tree = new UXC.Tree( $(&#x27;#tree_box&#x27;), treeData );
                _tree.init();
         */
        init:
            function(){
                this._view.init();
                this._view.treeRoot().data( &#x27;TreeIns&#x27;, this );
                return this;
            }    
        /**
         * 展开树到某个具体节点, 或者展开树的所有节点
         * @method  open
         * @param   {string|int}    _nodeId     如果_nodeId=&#x27;undefined&#x27;, 将会展开树的所有节点
         *                                      &lt;br /&gt;_nodeId 不为空, 将展开树到 _nodeId 所在的节点
         */
        , open:
            function( _nodeId ){
                if( typeof _nodeId == &#x27;undefined&#x27; ){
                    this._view.openAll();
                    return this;
                }
                this._view.open( _nodeId );
                return this;
            }
        /**
         * 关闭某个节点, 或者关闭整个树
         * @method  close
         * @param   {string|int}    _nodeId     如果_nodeId=&#x27;undefined&#x27;, 将会关闭树的所有节点
         *                                      &lt;br /&gt;_nodeId 不为空, 将关闭树 _nodeId 所在的节点
         */
        , close:
            function( _nodeId ){
                if( typeof _nodeId == &#x27;undefined&#x27; ){
                    this._view.closeAll();
                    return this;
                }
                this._view.close( _nodeId );
                return this;
            }
        /**
         * 获取树的 ID 前缀
         * &lt;br /&gt;每个树都会有自己的随机ID前缀
         * @method  idPrefix
         * @return  {string}    树的ID前缀
         */
        , idPrefix: function(){ return this._model.idPrefix(); }
        /**
         * 获取树的节点 label
         * @method  getItem
         * @param   {string|int}    _nodeId     
         */
        , getItem:
            function( _nodeId ){
                var _r;
                _nodeId &amp;&amp; ( _r = $(&#x27;#&#x27; + this._model.id( _nodeId ) ) );
                return _r;
            }
        /**
         * 绑定树内部事件
         * &lt;br /&gt;&lt;b&gt;注意:&lt;/b&gt; 所有事件名最终会被转换成小写
         * @method  on
         * @param   {string}    _evtName
         * @param   {function}  _cb
         */
        , on:
            function( _evtName, _cb ){
                if( !( _evtName &amp;&amp; _cb ) ) return this;
                this._model.addEvent( _evtName, _cb );
                return this;
            }
        /**
         * 获取树的某类事件类型的所有回调
         * @method  event
         * @param   {string}    _evtName
         * @return  {array}
         */
        , event: function( _evtName ){ if( !_evtName ) return; return this._model.event( _evtName ); }
        /**
         * 获取或设置树的高亮节点
         * &lt;br /&gt;&lt;b&gt;注意:&lt;/b&gt; 这个只是数据层面的设置, 不会影响视觉效果
         * @method  highlight
         * @param   {selector}  _item
         * @return  selector
         */
        , highlight:
            function( _item ){
                return this._model.highlight( _item );
            }
    }
    /**
     * 树节点的点击事件
     * @event   click
     * @param   {event}     _evt
     * @example
            _tree.on(&#x27;click&#x27;, function( _evt ){
                var _p = $(this);
                UXC.log( &#x27;tree click:&#x27;, _p.html(), _p.attr(&#x27;dataid&#x27;), _p.attr(&#x27;dataname&#x27;) );
            });
     */

    /**
     * 树节点的展现事件
     * @event   RenderLabel
     * @param   {array}     _data
     * @param   {selector}  _item
     * @example
            _tree.on(&#x27;RenderLabel&#x27;, function( _data ){
                var _node = $(this);
                _node.html( printf( &#x27;&lt;a href=&quot;javascript:&quot; dataid=&quot;{0}&quot;&gt;{1}&lt;/a&gt;&#x27;, _data[0], _data[1] ) );
            });
     */

    /**
     * 树文件夹的点击事件
     * @event   FolderClick
     * @param   {event}     _evt
     * @example
            _tree.on(&#x27;FolderClick&#x27;, function( _evt ){
                var _p = $(this);
                alert( &#x27;folder click&#x27; );
            });
     */

    /**
     * 树的数据模型类
     * @namespace   UXC.Tree
     * @class   Model
     * @constructor
     */
    function Model( _container, _data ){
        /**
         * 树要展示的容器
         * @property    _container
         * @type    selector
         * @private
         */
        this._container = _container;
        /**
         * 展现树需要的数据
         * @property    _data
         * @type    object
         * @private
         */
        this._data = _data;
        /**
         * 树的随机ID前缀
         * @property    _id
         * @type    string
         * @private
         */
        this._id = &#x27;tree_&#x27; + new Date().getTime() + &#x27;_&#x27;;
        /**
         * 树当前的高亮节点
         * @property    _highlight
         * @type    selector
         * @private
         */
        this._highlight;
        /**
         * 保存树的所有绑定事件
         * @property    _events
         * @type    object
         * @private
         */
        this._events = {};
        
        this._init();
    }
    
    Model.prototype = {
        /**
         * 树模型类内部初始化方法
         * @method  _init
         * @private
         */
        _init:
            function(){
                Tree.dataFilter &amp;&amp; ( this._data = Tree.dataFilter( this._data ) );
                return this;
            }
        /**
         * 获取树所要展示的容器
         * @method  container
         * @return  selector
         */
        , container: function(){ return this._container; }
        /**
         * 获取节点将要显示的ID
         * @method  id
         * @param   {string}    _id 节点的原始ID
         * @return  string  节点的最终ID
         */
        , id: function( _id ){ return this._id + _id; }
        /**
         *  获取树的随机ID前缀
         *  @method idPrefix
         *  @return string
         */
        , idPrefix: function(){ return this._id; }
        /**
         * 获取树的原始数据
         * @method  data
         * @return  object
         */
        , data: function(){ return this._data; }
        /**
         * 获取树生成后的根节点
         * @method  root
         * @return  selector
         */
        , root: function(){ return this._data.root; }
        /**
         * 获取ID的具体节点
         * @method  child
         * @param   {string}    _id
         * @return  selector
         */
        , child: function( _id ){ return this._data.data[ _id ]; }
        /**
         * 判断原始数据的某个ID是否有子级节点
         * @method  hasChild
         * @param   {string}    _id
         * @return  bool
         */
        , hasChild: function( _id ){ return _id in this._data.data; }
        /**
         * 获取树的某类绑定事件的所有回调
         * @method event
         * @param   {string}    _evtName
         * @return  {array|undefined}
         */
        , event:
            function( _evtName ){
                _evtName = _evtName.toLowerCase();
                return this._events[ _evtName ];
            }
        /**
         * 添加树内部事件
         * @method  addEvent
         * @param   {string}    _evtName
         * @param   {function}  _cb
         */
        , addEvent:
            function( _evtName, _cb ){
                _evtName = _evtName.toLowerCase();
                if( !( _evtName in this._events ) ) this._events[ _evtName ] = [];
                this._events[ _evtName ].unshift( _cb );
            }
        /**
         * 获取或设置树的高亮节点
         * &lt;br /&gt;&lt;b&gt;注意:&lt;/b&gt; 这个只是数据层面的设置, 不会影响视觉效果
         * @method  highlight
         * @param   {selector}  _item
         * @return  selector
         */
        , highlight:
            function( _highlight ){
                _highlight &amp;&amp; ( this._highlight = _highlight );
                return this._highlight;
            }
    };
    /**
     * 树的视图模型类
     */
    function View( _model ){
        /**
         * 树的数据模型引用
         * @property    _model
         * @type    UXC.Tree.Model
         * @private
         */
        this._model = _model;
        /**
         * 树生成后的根节点
         * @property    _treeRoot
         * @type    selector
         * @private
         */
        this._treeRoot;
    }
    
    View.prototype = {
        /**
         * 初始化树的可视状态
         * @method  init 
         */
        init:
            function() {
                if( !( this._model.data() &amp;&amp; this._model.root() ) ) return;
                this._process( this._model.child( this._model.root()[0] ), this._initRoot() );
                return this;
            }
        /**
         * 获取或设置树生成后的根节点
         * @method  treeRoot
         * @param   {string}    _setter
         * @return  selector
         */
        , treeRoot:
            function( _setter ){
                _setter &amp;&amp; ( this._treeRoot = _setter );
                return this._treeRoot;
            }
        /**
         * 处理树的展现效果
         * @method  _process
         * @param   {array}     _data   节点数据
         * @param   {selector}  _parentNode
         * @private
         */
        , _process:
            function( _data, _parentNode ){

                for( var i = 0, j = _data.length, _item, _isLast; i &lt; j; i++ ){
                    _item = _data[i];
                    _isLast = i === j - 1;

                    if( this._model.hasChild( _item[0] ) ){
                        this._initFolder( _parentNode, _item, _isLast );
                    }else{
                        this._initFile( _parentNode, _item, _isLast );
                    }
                }
            }
        /**
         * 初始化树根节点
         * @method  _initRoot
         * @private
         */
        , _initRoot:
            function(){
                var _p = this;

                if( !_p._model.data().root ) return;
                
                var _data = _p._model.data().root;
                var _parentNode = $( &#x27;&lt;ul class=&quot;tree_wrap&quot;&gt;&lt;/ul&gt;&#x27; );

                var _label = this._initLabel( _data );

                var _node = $( &#x27;&lt;li class=&quot;folder_open&quot;&gt;&lt;/li&gt;&#x27; );
                    _node.html( &#x27;&lt;span class=&quot;folder_img_root folderRoot folder_img_open&quot;&gt;&amp;nbsp;&lt;/span&gt;&#x27; );
                    _label.appendTo( _node );

                    _node.appendTo( _parentNode );
                    _parentNode.appendTo( _p._model.container() );

                    this.treeRoot( _parentNode );

                var _r =  $( &#x27;&lt;ul style=&quot;&quot; class=&quot;tree_wrap_inner&quot;&gt;&lt;/ul&gt;&#x27; )
                    _r.appendTo( _node );

                return _r;
            }
        /**
         * 初始化树的文件夹节点
         * @method  _initFolder
         * @param   {selector}  _parentNode
         * @param   {object}    _data
         * @param   {bool}      _isLast
         * @private
         */
        , _initFolder:
            function( _parentNode, _data, _isLast ){
                var _last = &#x27;&#x27;, _last1 = &#x27;&#x27;;
                    _isLast &amp;&amp; ( _last = &#x27;folder_span_lst &#x27;, _last1 = &#x27;folder_last&#x27; );

                var _label = this._initLabel( _data );

                var _node = $( printf( &#x27;&lt;li&gt;&lt;span class=&quot;folder_img_closed folder {1}&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&#x27;, _data[1], _last ) );
                    _node.addClass( printf( &#x27;folder_closed {0} folder&#x27;, _last1 ));
                    _label.appendTo( _node );

                var _r =  $( &#x27;&lt;ul style=&quot;display:none;&quot; class=&quot;folder_ul_lst&quot; &gt;&lt;/ul&gt;&#x27; )
                    _r.appendTo( _node );

                    _node.appendTo( _parentNode );
                    this._process( this._model.child( _data[0] ), _r );
            }
        /**
         * 初始化树的文件节点
         * @method  _initFile
         * @param   {selector}  _parentNode
         * @param   {object}    _data
         * @param   {bool}      _isLast
         * @private
         */
        , _initFile:
            function( _parentNode, _data, _isLast ){
                var _last = &#x27;folder_img_bottom &#x27;, _last1 = &#x27;&#x27;;
                    _isLast &amp;&amp; ( _last = &#x27;folder_img_last &#x27;, _last1 = &#x27;&#x27; );

                var _label = this._initLabel( _data );

                var _node = $( printf( &#x27;&lt;li&gt;&lt;span class=&quot;{1}file&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&#x27;, _data[1], _last ) );
                    _node.addClass( &#x27;folder_closed file&#x27;);
                    _label.appendTo( _node );

                    _node.appendTo( _parentNode );
            }
        /**
         * 初始化树的节点标签
         * @method  _initLabel
         * @private
         * @param   {object}    _data
         * @return  selector
         */
        , _initLabel:
            function( _data ){
                var _label = $(&#x27;&lt;div class=&quot;node_ctn&quot;&gt;&lt;/div&gt;&#x27;);
                    _label.attr( &#x27;id&#x27;, this._model.id( _data[0] ) )
                        .attr( &#x27;dataid&#x27;, _data[0] )
                        .attr( &#x27;dataname&#x27;, _data[1] )
                        .data( &#x27;nodeData&#x27;, _data );

                if( this._model.event( &#x27;RenderLabel&#x27; ) ){
                    $.each( this._model.event(&#x27;RenderLabel&#x27;), function( _ix, _cb ){
                        if( _cb.call( _label, _data, _label ) === false ) return false;
                    });
                }else{
                    _label.html( _data[1] || &#x27;没有标签&#x27; );
                }
                return _label;
            }
        /**
         * 展开树的所有节点
         * @method  openAll
         */
        , openAll:
            function(){
                if( !this.treeRoot() ) return;
                this.treeRoot().find(&#x27;span.folder_img_closed&#x27;).each( function(){
                    $(this).trigger(&#x27;click&#x27;);
                });
            }
        /**
         * 关闭树的所有节点
         * @method  closeAll
         */
        , closeAll:
            function(){
                if( !this.treeRoot() ) return;
                this.treeRoot().find(&#x27;span.folder_img_open, span.folder_img_root&#x27;).each( function(){
                    if( $(this).hasClass( &#x27;folder_img_closed&#x27; ) ) return;
                    $(this).trigger(&#x27;click&#x27;);
                });
            }
        /**
         * 展开树到具体节点
         * @method  open
         * @param   {string}    _nodeId
         */
        , open: 
            function( _nodeId ){
                if( !_nodeId ) return;
                var _tgr = $( &#x27;#&#x27; + this._model.id( _nodeId ) );
                if( !_tgr.length ) return;

                var lis = _tgr.parents(&#x27;li&#x27;);

                if( this._model.highlight() ) this._model.highlight().removeClass(&#x27;highlight&#x27;);
                _tgr.addClass( &#x27;highlight&#x27; );
                this._model.highlight( _tgr );

                lis.each( function(){
                    var _sp = $(this), _child = _sp.find( &#x27;&gt; span.folderRoot, &gt; span.folder&#x27; );
                    if( _child.length ){
                        if( _child.hasClass( &#x27;folder_img_open&#x27; ) ) return;
                        _child.trigger( &#x27;click&#x27; );
                    }
                });
            }
        /**
         * 关闭树的具体节点
         * @method  close
         * @param   {string}    _nodeId
         */
        , close:
            function( _nodeId ){
                if( !_nodeId ) return;
                var _tgr = $( &#x27;#&#x27; + this._model.id( _nodeId ) );
                if( !_tgr.length ) return;
                var _child = _tgr.parent(&#x27;li&#x27;).find( &#x27;&gt; span.folderRoot, &gt; span.folder&#x27; );
                if( _child.length ){
                    if( _child.hasClass( &#x27;folder_img_closed&#x27; ) ) return;
                    _child.trigger( &#x27;click&#x27; );
                }
                
            }

    };
    /**
     * 树的最后的 hover 节点
     * &lt;br /&gt;树的 hover 是全局属性, 页面上的所有树只会有一个当前 hover
     * @property    lastHover
     * @type    selector
     * @default null
     */
    Tree.lastHover = null;
    $(document).delegate( &#x27;ul.tree_wrap div.node_ctn&#x27;, &#x27;mouseenter&#x27;, function(){
        if( Tree.lastHover ) Tree.lastHover.removeClass(&#x27;ms_over&#x27;);
        $(this).addClass(&#x27;ms_over&#x27;);
        Tree.lastHover = $(this);
    });
    $(document).delegate( &#x27;ul.tree_wrap div.node_ctn&#x27;, &#x27;mouseleave&#x27;, function(){
        if( Tree.lastHover ) Tree.lastHover.removeClass(&#x27;ms_over&#x27;);
    });
    /**
     * 捕获树文件标签的点击事件
     */
    $(document).delegate( &#x27;ul.tree_wrap div.node_ctn&#x27;, &#x27;click&#x27;, function( _evt ){
        var _p = $(this)
            , _treeContainer = _p.parents( &#x27;ul.tree_wrap&#x27; )
            , _treeIns = _treeContainer.data(&#x27;TreeIns&#x27;);

        if( !_treeIns ) return;

        var _events = _treeIns.event( &#x27;click&#x27; );
        if( _events &amp;&amp; _events.length ){
            $.each( _events, function( _ix, _cb ){
                if( _cb.call( _p, _evt ) === false ) return false; 
            });
        }

        if( _treeIns.highlight() ) _treeIns.highlight().removeClass(&#x27;highlight&#x27;);
        _p.addClass(&#x27;highlight&#x27;);
        _treeIns.highlight( _p );

        var _events = _treeIns.event( &#x27;change&#x27; );
        if( _events &amp;&amp; _events.length ){
            $.each( _events, function( _ix, _cb ){
                if( _cb.call( _p, _evt ) === false ) return false; 
            });
        }
    });
    /**
     * 捕获树文件夹图标的点击事件
     */
    $(document).delegate( &#x27;ul.tree_wrap span.folder, ul.tree_wrap span.folderRoot&#x27;, &#x27;click&#x27;, function( _evt ){
        var _p = $(this), _pntLi = _p.parent(&#x27;li&#x27;), _childUl = _pntLi.find( &#x27;&gt; ul&#x27;);
        var _treeContainer = _p.parents( &#x27;ul.tree_wrap&#x27; )
        , _treeIns = _treeContainer.data(&#x27;TreeIns&#x27;);

        var _events = _treeIns.event( &#x27;FolderClick&#x27; );
        if( _events &amp;&amp; _events.length ){
            $.each( _events, function( _ix, _cb ){
                if( _cb.call( _p, _evt ) === false ) return false; 
            });
        }

        if( _p.hasClass( &#x27;folder_img_open&#x27; ) ){
            _p.removeClass( &#x27;folder_img_open&#x27; ).addClass( &#x27;folder_img_closed&#x27; );
            _childUl.hide();
        }else if( _p.hasClass( &#x27;folder_img_closed&#x27; ) ){
            _p.addClass( &#x27;folder_img_open&#x27; ).removeClass( &#x27;folder_img_closed&#x27; );
            _childUl.show();
        }

        if( _pntLi.hasClass(&#x27;folder_closed&#x27;) ){
            _pntLi.addClass(&#x27;folder_open&#x27;).removeClass(&#x27;folder_closed&#x27;);
        }else if( _pntLi.hasClass(&#x27;folder_open&#x27;) ){
            _pntLi.removeClass(&#x27;folder_open&#x27;).addClass(&#x27;folder_closed&#x27;);
        }
    });

}(jQuery));

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
