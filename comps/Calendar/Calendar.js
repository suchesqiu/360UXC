(function(e){!window.UXC&&(window.UXC={log:function(){}});window.ZINDEX_COUNT=window.ZINDEX_COUNT||50001;var f=UXC.Calendar=window.Calendar={pickDate:function(b){b=e(b);if(!(b&&b.length)){return}e("body > div.UXCCalendar").hide();f.lastIpt=b;b=e(b);var a=e.trim(b.attr("multidate")||"").toLowerCase();switch(a){case"week":f.pickWeek&&f.pickWeek(b);break;case"month":f.pickMonth&&f.pickMonth(b);break;case"season":f.pickSeason&&f.pickSeason(b);break;default:d.pickDate(b)}f.layoutInitedCallback&&f.layoutInitedCallback(e("body > div.UXCCalendar:visible"),b)},init:function(a){d.initTrigger(a)},autoInit:true,defaultDateSpan:20,lastIpt:null,setPosition:function(z,a){if(!(z&&a)){return}a.css({left:"-9999px",top:"-9999px","z-index":ZINDEX_COUNT++}).show();var c=a.width(),w=a.height(),b=z.width(),v=z.height(),r=z.offset(),s,u,y=e(window).width(),t=e(window).height(),x=e(document).scrollTop();s=r.left;u=r.top+v+5;if((u+w-x)>t){UXC.log("y overflow");u=r.top-w-3;if(u<x){u=x}}a.css({left:s+"px",top:u+"px"});UXC.log(c,w,b,v,r.left,r.top,y,t);UXC.log(x,s,u)},isCalendarElement:function(b){b=e(b);var a=0;if(b.length){if(b.hasClass("UXCCalendar_btn")){a=1}if(b.prop("nodeName")&&b.attr("datatype")&&b.prop("nodeName").toLowerCase()=="input"&&b.attr("datatype").toLowerCase()=="date"){a=1}if(b.prop("nodeName")&&b.attr("multidate")&&b.prop("nodeName").toLowerCase()=="input"){a=1}}return a},layoutInitedCallback:null,layoutHideCallback:null,domClickFilter:null,hide:function(){e("body > div.UXCCalendar").hide();f.layoutHideCallback&&f.layoutHideCallback(f.lastIpt)},getDate:function(c){var a={date:0,minvalue:0,maxvalue:0,initMinvalue:0,initMaxvalue:0},b;if(b=parseISODate(c.val())){a.date=b}else{if(c.val()&&(b=c.val().replace(/[^\d]/g,"")).length==16){a.date=parseISODate(b.slice(0,8));a.rangeStart=cloneDate(a.date);a.rangeEnd=parseISODate(b.slice(8))}else{a.date=new Date()}}a.minvalue=parseISODate(c.attr("minvalue"));a.maxvalue=parseISODate(c.attr("maxvalue"));f.updateInitYearList(a);return a},updateInitYearList:function(a){a.initMinvalue=cloneDate(a.date);a.initMinvalue.setFullYear(a.initMinvalue.getFullYear()-f.defaultDateSpan);a.initMaxvalue=cloneDate(a.date);a.initMaxvalue.setFullYear(a.initMaxvalue.getFullYear()+f.defaultDateSpan)},cnWeek:"日一二三四五六",cnUnit:"十一二三四五六七八九",getCnNum:function(b){var a=f.cnUnit.charAt(b%10);b>10&&(a=(b%10!==0?f.cnUnit.charAt(0):"")+a);b>19&&(a=f.cnUnit.charAt(Math.floor(b/10))+a);return a},tpl:""};var d={initTrigger:function(a){a.each(function(){var c=e(this),h=(c.prop("nodeName")||"").toLowerCase();UXC.log("\nCalendar.init: ",h);if(h!="input"){arguments.callee(a.query(e("input[type=text]")));return}if(!(e.trim(c.attr("datatype")||"").toLowerCase()=="date"||e.trim(c.attr("multidate")||"")||e.trim(c.attr("datatype")||"").toLowerCase()=="daterange")){return}UXC.log("find Calendar item:",c.attr("name"),c.attr("id"),c.attr("datatype"));var b=c.find("+ input.UXCCalendar_btn");if(!b.length){c.after(b=e('<input type="button" class="UXCCalendar_btn"  />'))}b[0].forCalendar=c})},lastDateObj:null,pickDate:function(b){UXC.log("Calendar.pickDate",new Date().getTime());b=e(b);var a=d.lastDateObj=f.getDate(b);UXC.log(a.date.getFullYear(),a.date.getMonth()+1,a.date.getDate());d.initDateLayout(a);f.setPosition(b,d.getLayout());b.blur()},initDateLayout:function(a){f.updateInitYearList(a);d.initYear(a);d.initMonth(a);d.initMonthDate(a)},initMonthDate:function(a){var E=d.getLayout();var F=maxDayOfMonth(a.date),w=a.date.getDay()||7,b=w+F,A=6,C=[],B,D,u,y,x;var z=new Date(a.date.getFullYear(),a.date.getMonth(),1);var v=z.getDay()||7;if(v<2){z.setDate(-(v-1+6))}else{z.setDate(-(v-2))}var c=new Date();C.push("<tr>");for(y=1;y<=42;y++){x=[];if(z.getDay()===0||z.getDay()==6){x.push("weekend")}if(!isSameMonth(a.date,z)){x.push("other")}if(a.minvalue&&z.getTime()<a.minvalue.getTime()){x.push("unable")}if(a.maxvalue&&z.getTime()>a.maxvalue.getTime()){x.push("unable")}if(isSameDay(z,c)){x.push("today")}if(isSameDay(a.date,z)){x.push("cur")}C.push('<td class="',x.join(" "),'">','<a href="javascript:" date="',z.getTime(),'" title="'+formatISODate(z)+'" >',z.getDate(),"</a></td>");z.setDate(z.getDate()+1);if(y%7===0&&y!=42){C.push("</tr><tr>")}}C.push("</tr>");E.find("table.UTableBorder tbody").html(e(C.join("")));UXC.log(D,B,F,w,b,A)},initMonth:function(b){var a=d.getLayout();e(a.find("select.UMonth").val(b.date.getMonth()))},initYear:function(b){var a=d.getLayout(),n=[],p,o,q=b.initMinvalue.getFullYear(),c=b.initMaxvalue.getFullYear();UXC.log(q,c);if(!o){o=b.date.getFullYear()}for(var r=q;r<=c;r++){p="";if(o===r){p=" selected "}n.push('<option value="'+r+'"'+p+">"+r+"</option>")}e(n.join("")).appendTo(a.find("select.UYear").html(""))},updateYear:function(b){UXC.log(b);if(!d.lastDateObj){return}var a=maxDayOfMonth(d.lastDateObj.date),c=new Date(b,d.lastDateObj.date.getMonth(),1),h=maxDayOfMonth(c);if(a>h){c.setDate(h)}else{c.setDate(d.lastDateObj.date.getDate())}d.lastDateObj.date=c;d.initDateLayout(d.lastDateObj)},setNewMonth:function(b){UXC.log(b);if(!d.lastDateObj){return}var a=maxDayOfMonth(d.lastDateObj.date),c=new Date(d.lastDateObj.date.getFullYear(),b,1),h=maxDayOfMonth(c);if(a>h){c.setDate(h)}else{c.setDate(d.lastDateObj.date.getDate())}d.lastDateObj.date=c;d.initMonth(d.lastDateObj);d.initMonthDate(d.lastDateObj)},getLayout:function(){var a=e("#UXCCalendar");if(!a.length){a=e(f.tpl||d.tpl);a.attr("id","UXCCalendar").hide().appendTo(document.body);var b=e(['<option value="0">一月</option>','<option value="1">二月</option>','<option value="2">三月</option>','<option value="3">四月</option>','<option value="4">五月</option>','<option value="5">六月</option>','<option value="6">七月</option>','<option value="7">八月</option>','<option value="8">九月</option>','<option value="9">十月</option>','<option value="10">十一月</option>','<option value="11">十二月</option>'].join("")).appendTo(a.find("select.UMonth"));a.hide();a.data("confirmMethod",d.onConfirm);a.data("updateYearMethod",d.updateYear)}return a},setDate:function(a){if(!(a&&f.lastIpt&&f.lastIpt.length)){return}var c=new Date(),k="-";c.setTime(a);var b=f.lastIpt.attr("dateFormat");if(b){b=b.replace(/[\da-zA-Z]/g,"");if(b.length){b=b.slice(0,1)}k=b}var l=formatISODate(c,k);f.lastIpt.val(l).focus()},onConfirm:function(){var a;a=d.getLayout().find("table td.cur a");if(a.parent("td").hasClass("unable")){return 0}a&&a.length&&a.attr("date")&&d.setDate(a.attr("date"));return 1},tpl:['<div id="UXCCalendar" class="UXCCalendar">\n','    <div class="UHeader">\n','        <select class="UYear"></select>\n','        <img class="UImg yearctl" align="absMiddle" usemap="#UXCCalendar_Year" />\n','        <map name="UXCCalendar_Year"><area shape="rect" coords="0,0,13,8" href="#" action="up"><area shape="rect" coords="0,10,13,17" href="#" action="down"></map>\n','        <select class="UMonth"></select>\n','        <img class="UImg monthctl" align="absMiddle" usemap="#UXCCalendar_Month"  />\n','        <map name="UXCCalendar_Month"><area shape="rect" coords="0,0,13,8" href="#" action="up"><area shape="rect" coords="0,10,13,17" href="#" action="down"></map>\n',"    </div>\n",'    <table class="UTable">\n',"        <thead>\n","            <tr>\n","                <th>一</th>\n","                <th>二</th>\n","                <th>三</th>\n","                <th>四</th>\n","                <th>五</th>\n","                <th>六</th>\n","                <th>日</th>\n","            </tr>\n","        </thead>\n","   </table>\n",'   <table class="UTable UTableBorder">\n',"        <tbody>\n","           <!--<tr>\n",'                <td class="cur"><a href="#">2</a></td>\n','                <td class="unable"><a href="#">2</a></td>\n','                <td class="weekend cur"><a href="#">6</a></td>\n','                <td class="weekend hover"><a href="#">13</a></td>\n','                <td class="weekend other"><a href="#">41</a></td>\n','                <td class="weekend other"><a href="#">42</a></td>\n',"            </tr>\n-->","        </tbody>\n","    </table>\n",'    <div class="UFooter">\n','        <button type="button" class="UConfirm">确定</button>\n','        <button type="button" class="UClear">清空</button>\n','        <button type="button" class="UCancel">取消</button>\n',"    </div>\n","</div>\n"].join("")};e(document).ready(function(a){setTimeout(function(b){if(!f.autoInit){return}f.init(e("input[type=text]"))},200);e(document).delegate("body > div.UXCCalendar select.UYear","change",function(c){var b=e(this).parents("div.UXCCalendar");b.length&&b.data("updateYearMethod")&&b.data("updateYearMethod")(e(this).val())});e(document).delegate("body > div.UXCCalendar button.UNextYear","click",function(c){var b=e(this).parents("div.UXCCalendar");b.length&&b.data("nextYearMethod")&&b.data("nextYearMethod")()});e(document).delegate("body > div.UXCCalendar button.UPreYear","click",function(c){var b=e(this).parents("div.UXCCalendar");b.length&&b.data("preYearMethod")&&b.data("preYearMethod")()});e(document).delegate("#UXCCalendar select.UMonth","change",function(b){d.setNewMonth(e(this).val())});e(document).delegate("body > div.UXCCalendar button.UConfirm","click",function(c){var b=e(this).parents("div.UXCCalendar");b.length&&b.data("confirmMethod")&&b.data("confirmMethod")(this);f.hide()});e(document).delegate("map[name=UXCCalendar_Year] area","click",function(c){c.preventDefault();var h=e(this),b=d.lastDateObj;if(!(b&&h.attr("action"))){return}if(h.attr("action").toLowerCase()=="up"){b.date.setFullYear(b.date.getFullYear()+1)}else{if(h.attr("action").toLowerCase()=="down"){b.date.setFullYear(b.date.getFullYear()-1)}}d.initDateLayout(b);UXC.log(h.attr("action"))});e(document).delegate("map[name=UXCCalendar_Month] area","click",function(c){c.preventDefault();var h=e(this),b=d.lastDateObj;if(!(b&&h.attr("action"))){return}if(h.attr("action").toLowerCase()=="up"){b.date.setMonth(b.date.getMonth()+1);b.initMinvalue.setMonth(b.initMinvalue.getMonth()+1);b.initMaxvalue.setMonth(b.initMaxvalue.getMonth()+1)}else{if(h.attr("action").toLowerCase()=="down"){b.date.setMonth(b.date.getMonth()-1);b.initMinvalue.setMonth(b.initMinvalue.getMonth()-1);b.initMaxvalue.setMonth(b.initMaxvalue.getMonth()-1)}}d.initDateLayout(b);UXC.log(h.attr("action"))});e(document).delegate("body > div.UXCCalendar button.UClear","click",function(b){f.lastIpt&&f.lastIpt.length&&f.lastIpt.val("")});e(document).delegate("body > div.UXCCalendar button.UCancel","click",function(b){f.hide()});e(document).on("click",function(c){var b=c.target||c.srcElement;if(f.domClickFilter){if(f.domClickFilter(e(b))===false){return}}if(f.isCalendarElement(c.target||c.targetElement)){return}if(b&&b.nodeName.toLowerCase()!="input"){f.hide();return}setTimeout(function(){if(f.lastIpt&&f.lastIpt.length&&b==f.lastIpt[0]){return}f.hide()},100)});e(document).delegate("input.UXCCalendar_btn","click",function(b){if(this.forCalendar){f.pickDate(this.forCalendar)}});e(document).delegate("input[datatype=date], input[datatype=daterange], input[multidate]","focus",function(b){f.pickDate(this)});e(document).delegate("body > div.UXCCalendar","click",function(b){b.stopPropagation()});e(document).delegate("#UXCCalendar table a","click",function(c){c.preventDefault();var h=e(this),b=h.attr("date")||"";if(!b){return}if(h.parent("td").hasClass("unable")){return}UXC.log(b);d.setDate(b);f.hide()});e(window).on("scroll resize",function(c){var b=e("body > div.UXCCalendar:visible");if(!(b.length&&f.lastIpt)){return}f.setPosition(f.lastIpt,b)})})}(jQuery));(function(d){UXC.Calendar.pickWeek=function(a){f.lastDateObj=UXC.Calendar.getDate(a);UXC.Calendar.lastIpt=a;UXC.Calendar.setPosition(a,f.update(f.lastDateObj))};UXC.Calendar.pickWeek.tpl="";UXC.Calendar.pickWeek.dayOffset=1;var f={getLayout:function(){var a;if(!(a=d("#UXCCalendar_week")).length){a=d(UXC.Calendar.pickWeek.tpl||f.tpl);a.appendTo(document.body);a.data("confirmMethod",f.onConfirm);a.data("updateYearMethod",f.updateYear);a.data("nextYearMethod",f.nextYear);a.data("preYearMethod",f.preYear)}return a},onConfirm:function(){UXC.log("Calendar.pickWeek, onConfirm");var a=f.getLayout().find("td.cur");if(!a.length){f.getLayout().find("td.today")}if(a.length){a.find("a").trigger("click")}},updateYear:function(a){if(!f.lastDateObj){return}f.lastDateObj.date.setFullYear(a);UXC.Calendar.updateInitYearList(f.lastDateObj);f.update(f.lastDateObj)},nextYear:function(){UXC.log("nextYearMethod");if(!f.lastDateObj){return}f.updateYear(f.lastDateObj.date.getFullYear()+1)},preYear:function(){UXC.log("preYearMethod");if(!f.lastDateObj){return}f.updateYear(f.lastDateObj.date.getFullYear()-1)},update:function(a){f.getLayout();f.updateHead(a);f.updateBody(a);return f.getLayout()},updateHead:function(b){var a=f.getLayout(),n=[],p,o,q=b.initMinvalue.getFullYear(),c=b.initMaxvalue.getFullYear();if(!o){o=b.date.getFullYear()}for(var r=q;r<=c;r++){p="";if(o===r){p=" selected "}n.push('<option value="'+r+'"'+p+">"+r+"</option>")}d(n.join("")).appendTo(a.find("select.UYear").html(""))},updateBody:function(b){var E=b.date;var F=f.getLayout();F.find("button.UYearButton").html(E.getFullYear());var u=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()).getTime();var D=e(E.getFullYear(),UXC.Calendar.pickWeek.dayOffset);var C=e(E.getFullYear()+1,UXC.Calendar.pickWeek.dayOffset);var w=0;var B=[],x,A,a,y,v,z=E.getFullYear(),c=Math.ceil(D.length/8);B.push("<tr>");for(i=1,j=c*8;i<=j;i++){A=D[i-1];if(!A){A=C[w++];z=E.getFullYear()+1}y=new Date();v=new Date();y.setTime(A.start);v.setTime(A.end);a=printf("{0}年 第{1}周<br/>开始日期: {2} (周{4})<br />结束日期: {3} (周{5})",z,UXC.Calendar.getCnNum(A.week),formatISODate(y),formatISODate(v),UXC.Calendar.cnWeek.charAt(y.getDay()%7),UXC.Calendar.cnWeek.charAt(v.getDay()%7));x=[];if(b.minvalue&&y.getTime()<b.minvalue.getTime()){x.push("unable")}if(b.maxvalue&&v.getTime()>b.maxvalue.getTime()){x.push("unable")}if(E.getTime()>=y.getTime()&&E.getTime()<=v.getTime()){x.push("cur")}if(u>=y.getTime()&&u<=v.getTime()){x.push("today")}B.push(printf('<td class="{0}"><a href="javascript:" title="{2}" dstart="{3}" dend="{4}" week="{1}" >{1}</a></td>',x.join(" "),A.week,a,y.getTime(),v.getTime()));if(i%8===0&&i!=j){B.push("</tr><tr>")}}B.push("</tr>");F.find("table.UTableBorder tbody").html(d(B.join("")))},lastDateObj:null,tpl:['<div id="UXCCalendar_week" class="UXCCalendar UXCCalendar_week" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("")};function e(c,l){var a=[],b,m=1,l=l||0,c=parseInt(c,10),n=new Date(c,0,1);n.getDay()>1&&n.setDate(n.getDate()-n.getDay()+7);l>0&&(l=(new Date(2000,1,2)-new Date(2000,1,1))*l);while(n.getFullYear()<=c){b={week:m++,start:null,end:null};b.start=n.getTime()+l;n.setDate(n.getDate()+6);b.end=n.getTime()+l;n.setDate(n.getDate()+1);if(n.getFullYear()>c){n=new Date(n.getFullYear(),0,1);if(n.getDay()<2){break}}a.push(b)}return a}d(document).delegate("#UXCCalendar_week table a","click",function(c){var b=d(this),h=new Date(),a=new Date();if(!UXC.Calendar.lastIpt){return}if(b.parent("td").hasClass("unable")){return}h.setTime(b.attr("dstart"));a.setTime(b.attr("dend"));UXC.Calendar.lastIpt.val(printf("{0} 至 {1}",formatISODate(h),formatISODate(a)));UXC.Calendar.hide()})}(jQuery));(function(d){UXC.Calendar.pickMonth=function(a){c.lastDateObj=UXC.Calendar.getDate(a);UXC.Calendar.lastIpt=a;UXC.Calendar.setPosition(a,c.update(c.lastDateObj))};UXC.Calendar.pickMonth.tpl="";var c={getLayout:function(){var a;if(!(a=d("#UXCCalendar_month")).length){a=d(UXC.Calendar.pickMonth.tpl||c.tpl);a.appendTo(document.body);a.data("confirmMethod",c.onConfirm);a.data("updateYearMethod",c.updateYear);a.data("nextYearMethod",c.nextYear);a.data("preYearMethod",c.preYear)}return a},onConfirm:function(){UXC.log("Calendar.pickMonth, onConfirm");var a=c.getLayout().find("td.cur");if(!a.length){c.getLayout().find("td.today")}if(a.length){a.find("a").trigger("click")}},updateYear:function(a){if(!c.lastDateObj){return}c.lastDateObj.date.setFullYear(a);UXC.Calendar.updateInitYearList(c.lastDateObj);c.update(c.lastDateObj)},nextYear:function(){UXC.log("nextYearMethod");if(!c.lastDateObj){return}c.updateYear(c.lastDateObj.date.getFullYear()+1)},preYear:function(){UXC.log("preYearMethod");if(!c.lastDateObj){return}c.updateYear(c.lastDateObj.date.getFullYear()-1)},update:function(a){c.getLayout();c.updateHead(a);c.updateBody(a);return c.getLayout()},updateHead:function(b){var a=c.getLayout(),n=[],p,o,q=b.initMinvalue.getFullYear(),m=b.initMaxvalue.getFullYear();if(!o){o=b.date.getFullYear()}for(var r=q;r<=m;r++){p="";if(o===r){p=" selected "}n.push('<option value="'+r+'"'+p+">"+r+"</option>")}d(n.join("")).appendTo(a.find("select.UYear").html(""))},updateBody:function(r){var a=r.date;var b=c.getLayout();b.find("button.UYearButton").html(a.getFullYear());var s=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()).getTime();var z=[],u,y,q,w,t,v,x=a.getFullYear();z.push("<tr>");for(i=1,j=12;i<=j;i++){w=new Date(x,i-1,1);t=new Date(x,i-1,maxDayOfMonth(w));q=printf("{0}年 {1}月<br/>开始日期: {2} (周{4})<br />结束日期: {3} (周{5})",x,UXC.Calendar.getCnNum(i),formatISODate(w),formatISODate(t),UXC.Calendar.cnWeek.charAt(w.getDay()%7),UXC.Calendar.cnWeek.charAt(t.getDay()%7));u=[];if(r.minvalue&&w.getTime()<r.minvalue.getTime()){u.push("unable")}if(r.maxvalue&&t.getTime()>r.maxvalue.getTime()){u.push("unable")}if(a.getTime()>=w.getTime()&&a.getTime()<=t.getTime()){u.push("cur")}if(s>=w.getTime()&&s<=t.getTime()){u.push("today")}v=UXC.Calendar.cnUnit.charAt(i%10);i>10&&(v="十"+v);z.push(printf('<td class="{0}"><a href="javascript:" title="{1}" dstart="{3}" dend="{4}" month="{5}" >{2}月</a></td>',u.join(" "),q,v,w.getTime(),t.getTime(),i));if(i%3===0&&i!=j){z.push("</tr><tr>")}}z.push("</tr>");b.find("table.UTableBorder tbody").html(d(z.join("")))},lastDateObj:null,tpl:['<div id="UXCCalendar_month" class="UXCCalendar UXCCalendar_week UXCCalendar_month" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("")};d(document).delegate("#UXCCalendar_month table a","click",function(g){var b=d(this),h=new Date(),a=new Date();if(!UXC.Calendar.lastIpt){return}if(b.parent("td").hasClass("unable")){return}h.setTime(b.attr("dstart"));a.setTime(b.attr("dend"));UXC.Calendar.lastIpt.val(printf("{0} 至 {1}",formatISODate(h),formatISODate(a)));UXC.Calendar.hide()})}(jQuery));(function(d){UXC.Calendar.pickSeason=function(a){c.lastDateObj=UXC.Calendar.getDate(a);UXC.Calendar.lastIpt=a;UXC.Calendar.setPosition(a,c.update(c.lastDateObj))};UXC.Calendar.pickSeason.tpl="";var c={getLayout:function(){var a;if(!(a=d("#UXCCalendar_season")).length){a=d(UXC.Calendar.pickSeason.tpl||c.tpl);a.appendTo(document.body);a.data("confirmMethod",c.onConfirm);a.data("updateYearMethod",c.updateYear);a.data("nextYearMethod",c.nextYear);a.data("preYearMethod",c.preYear)}return a},onConfirm:function(){UXC.log("Calendar.pickSeason, onConfirm");var a=c.getLayout().find("td.cur");if(!a.length){c.getLayout().find("td.today")}if(a.length){a.find("a").trigger("click")}},updateYear:function(a){if(!c.lastDateObj){return}c.lastDateObj.date.setFullYear(a);UXC.Calendar.updateInitYearList(c.lastDateObj);c.update(c.lastDateObj)},nextYear:function(){UXC.log("nextYearMethod");if(!c.lastDateObj){return}c.updateYear(c.lastDateObj.date.getFullYear()+1)},preYear:function(){UXC.log("preYearMethod");if(!c.lastDateObj){return}c.updateYear(c.lastDateObj.date.getFullYear()-1)},update:function(a){c.getLayout();c.updateHead(a);c.updateBody(a);return c.getLayout()},updateHead:function(b){var a=c.getLayout(),n=[],p,o,q=b.initMinvalue.getFullYear(),m=b.initMaxvalue.getFullYear();if(!o){o=b.date.getFullYear()}for(var r=q;r<=m;r++){p="";if(o===r){p=" selected "}n.push('<option value="'+r+'"'+p+">"+r+"</option>")}d(n.join("")).appendTo(a.find("select.UYear").html(""))},updateBody:function(r){var a=r.date;var b=c.getLayout();b.find("button.UYearButton").html(a.getFullYear());var s=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()).getTime();var z=[],u,y,q,w,t,v,x=a.getFullYear();z.push("<tr>");for(i=1,j=4;i<=j;i++){w=new Date(x,i*3-3,1);t=new Date(x,i*3-1,1);t.setDate(maxDayOfMonth(t));v=UXC.Calendar.cnUnit.charAt(i%10);i>10&&(v="十"+v);q=printf("{0}年 第{1}季度<br/>开始日期: {2} (周{4})<br />结束日期: {3} (周{5})",x,UXC.Calendar.getCnNum(i),formatISODate(w),formatISODate(t),UXC.Calendar.cnWeek.charAt(w.getDay()%7),UXC.Calendar.cnWeek.charAt(t.getDay()%7));u=[];if(r.minvalue&&w.getTime()<r.minvalue.getTime()){u.push("unable")}if(r.maxvalue&&t.getTime()>r.maxvalue.getTime()){u.push("unable")}if(a.getTime()>=w.getTime()&&a.getTime()<=t.getTime()){u.push("cur")}if(s>=w.getTime()&&s<=t.getTime()){u.push("today")}z.push(printf('<td class="{0}"><a href="javascript:" title="{1}" dstart="{3}" dend="{4}" month="{5}" >{2}季度</a></td>',u.join(" "),q,v,w.getTime(),t.getTime(),i));if(i%2===0&&i!=j){z.push("</tr><tr>")}}z.push("</tr>");b.find("table.UTableBorder tbody").html(d(z.join("")))},lastDateObj:null,tpl:['<div id="UXCCalendar_season" class="UXCCalendar UXCCalendar_week UXCCalendar_season" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("")};d(document).delegate("#UXCCalendar_season table a","click",function(g){var b=d(this),h=new Date(),a=new Date();if(!UXC.Calendar.lastIpt){return}if(b.parent("td").hasClass("unable")){return}h.setTime(b.attr("dstart"));a.setTime(b.attr("dend"));UXC.Calendar.lastIpt.val(printf("{0} 至 {1}",formatISODate(h),formatISODate(a)));UXC.Calendar.hide()})}(jQuery));