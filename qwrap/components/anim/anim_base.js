(function(){var g=QW.CustEvent,k=QW.ObjectH.mix;var l=function(c,b,a){k(this,a);k(this,{animFun:c,dur:b,byStep:false,per:0,frameTime:28,_status:0});i(this,this.per);g.createEvents(this,l.EVENTS)};l.EVENTS="beforeplay,play,step,pause,resume,end,reset".split(",");function j(a){a.step();if(a.isPlaying()){a._interval=window.setInterval(function(){a.step()},a.frameTime)}}function h(a){window.clearInterval(a._interval)}function i(a,b){a.per=b;a._startDate=new Date()*1-b*a.dur;if(a.byStep){a._totalStep=a.dur/a.frameTime;a._currentStep=b*a._totalStep}}k(l.prototype,{isPlaying:function(){return this._status==1},play:function(){var a=this;if(a.isPlaying()){a.pause()}i(a,0);if(!a.fire("beforeplay")){return false}a._status=1;a.fire("play");j(a);return true},step:function(b){var a=this;if(b!=null){i(a,b)}else{if(a.byStep){b=a._currentStep++/a._totalStep}else{b=(new Date()-a._startDate)/a.dur}this.per=b}if(this.per>1){this.per=1}a.animFun(this.per);a.fire("step");if(this.per>=1){this.end();return}},end:function(){i(this,1);this.animFun(1);this._status=2;h(this);this.fire("end")},pause:function(){this._status=4;h(this);this.fire("pause")},resume:function(){i(this,this.per);this._status=1;this.fire("resume");j(this)},reset:function(){i(this,0);this.animFun(0);this.fire("reset")}});QW.provide("Anim",l)}());