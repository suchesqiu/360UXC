(function(){function C(a){QW.ObjectH.mix(this,a,true);if(!this.lazyRender){this.render()}}var q=(/msie/i).test(navigator.userAgent);var w=QW.EventH.getTarget,D=QW.DomU.createElement,B=QW.EventTargetH.addEventListener,s=QW.NodeH,A=s.hasClass,v=s.addClass,g=s.removeClass,t=s.replaceClass,r=s.show,x=s.hide,z=s.ancestorNode,y=s.g;var u=0;C.prototype={rootItemData:["folderRoot","0","Root示例"],loadItemsData:function(a){this.setItemsData(a,this.dataSource[a],true)},getItemHtml:function(a){return"需要重写"},getNoDataHtml:function(a){return"没有数据"},setItemsData:function(a,c,b){var d=y(this._idPre+a);if(!d){alert("程序错误：节点还没生成："+a);return}d.itemsData=c||[];d.dataIsLoading=false;if(b){this._renderItems(a)}},openFolder:function(b){var a=y(this._idPre+b);if(!a){alert("程序错误：节点还没生成："+b);return}var c=a.childNodes[2];if(!c.innerHTML){if(!a.itemsData&&!a.dataIsLoading){v(a.firstChild,"folder-img-loading");this.loadItemsData(b)}this._renderItems(b,true)}t(a,"folder-closed","folder-open");t(a.firstChild,"folder-img-closed","folder-img-open");r(c)},closeFolder:function(b){var a=y(this._idPre+b);if(!a){alert("程序错误：节点还没生成："+b);return}t(a,"folder-open","folder-closed");t(a.firstChild,"folder-img-open","folder-img-closed");x(a.childNodes[2])},openFolders:function(b){for(var a=0;a<b.length;a++){this.openFolder(b[a])}},refreshFolder:function(b){var a=y(this._idPre+b);if(!a){alert("程序错误：节点还没生成："+b);return}v(a.firstChild,"folder-img-loading");a.childNodes[2].innerHTML="";this.loadItemsData(b)},focusItem:function(a){var c=y(this._idPre+a);if(!c){alert("程序错误：节点还没生成："+a);return}var e=c.getElementsByTagName("a");try{if(e.length){if(this._highlightEl){try{g(this._highlightEl,"highlight")}catch(d){}}var f=e[0];f.focus();v(f,"highlight");this._highlightEl=f}else{c.scrollIntoView()}}catch(b){}},_highlightEl:null,_idPre:"",_renderItems:function(c,i){var b=y(this._idPre+c);var e=b.itemsData;if(!e){if(!i){alert("还没有load出数据来呢!")}return false}var d=b.childNodes[2];if(e.length){var j=[];for(var a=0;a<e.length;a++){var h=e[a];var f=this.getItemHtml(h);if(h[0].toLowerCase().indexOf("folder")>-1){j[a]='<li id="'+this._idPre+h[1]+'" class="folder-closed '+h[0]+'"><span class="folder-img-closed '+h[0]+'">&nbsp;</span><div class="node-ctn">'+f+'</div><ul style="display:none"></ul></li>'}else{j[a]='<li id="'+this._idPre+h[1]+'" class="folder-closed '+h[0]+'"><span class="folder-img-bottom '+h[0]+'">&nbsp;</span><div class="node-ctn">'+f+"</div></li>";j[e.length]='<li id="'+this._idPre+h[1]+'" class="folder-closed '+h[0]+'"><span class="folder-img-last '+h[0]+'">&nbsp;</span><div class="node-ctn">'+f+"</div></li>"}}d.innerHTML=j.join("")}else{d.innerHTML="<li>"+this.getNoDataHtml(c)+"</li>"}g(b.firstChild,"folder-img-loading")},_mouseover:function(c){var b=w(c);if(b.tagName=="UL"){return}if(b.tagName!="LI"){b=z(b,"LI")}var a=b.getElementsByTagName("div")[0];if(a){v(a,"ms-over")}},_mouseout:function(c){var b=w(c);if(b.tagName=="UL"){return}if(b.tagName!="LI"){b=z(b,"LI")}var a=b.getElementsByTagName("div")[0];if(a){g(a,"ms-over")}},_click:function(b){var a=w(b);if(A(a,"folder-img-closed")){this.openFolder(a.parentNode.id.substr(this._idPre.length))}else{if(A(a,"folder-img-open")){this.closeFolder(a.parentNode.id.substr(this._idPre.length))}}},render:function(){var c=this;if(c._rendered){return}c._rendered=true;this._idPre="tree"+(++u)+"_";var b=c.rootItemData;c.treeCtn.innerHTML='<ul class="tree-wrap"><li id="'+this._idPre+b[1]+'"><span class="folder-img-root '+b[0]+'">&nbsp;</span><div class="node-ctn">'+b[2]+'</div><ul style="display:none" class="tree-wrap-inner"></ul></li></ul>';var a=this.treeCtn.firstChild;B(a,"mouseover",function(d){c._mouseover(d)});B(a,"mouseout",function(d){c._mouseout(d)});B(a,"click",function(d){c._click(d)});c.openFolder(b[1])}};QW.provide("Tree",C)})();