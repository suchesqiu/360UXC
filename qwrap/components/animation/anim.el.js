(function(){var g=QW.Anim,A=QW.ClassH.extend,B=QW.NodeH.g,K=QW.ObjectH.mix,T=QW.ObjectH.isFunction,J=QW.ObjectH.isString,E=QW.DomU.isElement,G=QW.ObjectH.isPlainObject,D=QW.NodeH.isVisible,S=QW.NodeH.setStyle,M=QW.NodeH.getCurrentStyle,Q=QW.NodeH.getStyle,C=QW.NodeH.removeStyle,y=Array.map||QW.ArrayH.map,z=QW.NodeH.show,L=QW.NodeH.hide;function F(d,c,b,a){this.el=d;this.attr=b;this.anim=a;if(J(c)){if(c in O.agentHooks){c=O.agentHooks[c](c,b,d,a)}else{c=O.agentHooks._default(c,b,d,a)}}else{if(T(c)){c=c(c,b,d,a)}else{if(!G(c)){c={to:c}}}}K(this,c);this.init()}K(F.prototype,{setValue:function(a){S(this.el,this.attr,a)},getValue:function(){return M(this.el,this.attr)},getUnit:function(a){if(this.unit){return this.unit}var b=this.getValue();if(b){return b.toString().replace(/^[+-]?[\d\.]+/g,"")}return""},init:function(){var a,c,d,b;if(null!=this.from){a=parseFloat(this.from)}else{a=parseFloat(this.getValue())||0}c=parseFloat(this.to);d=this.by!=null?parseFloat(this.by):(c-a);this.from=a;this.by=d;this.unit=this.getUnit()},action:function(a){var c=this.unit;var b=this.from+this.easing(a,this.by);b=b.toFixed(6);this.setValue(b+c)}});var H=A(function(c,b,a){this.__overflow=Q(c,"overflow");S(c,"overflow","hidden");H.$super.apply(this,arguments)},F);K(H.prototype,{getUnit:function(a){if(this.unit){return this.unit}var b=this.getValue();if(b){return b.toString().replace(/^[+-]?[\d\.]+/g,"")}return"px"},finished:function(){if(this.__overflow){S(this.el,"overflow",this.__overflow)}}},true);var I=A(function(){I.$super.apply(this,arguments)},F);K(I.prototype,{getValue:function(){return this.el[this.attr]|0},setValue:function(a){this.el[this.attr]=Math.round(a)}},true);var P=A(function(){P.$super.apply(this,arguments)},F);K(P.prototype,{parseColor:function(c){var a={rgb:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,hex:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,hex3:/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i};if(c.length==3){return c}var b=a.hex.exec(c);if(b&&b.length==4){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}b=a.rgb.exec(c);if(b&&b.length==4){return[parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10)]}b=a.hex3.exec(c);if(b&&b.length==4){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}return[0,0,0]},init:function(){var e,a,c,b;var d=this.parseColor;if(null!=this.from){e=this.from}else{e=this.getValue()}e=d(e);a=this.to||[0,0,0];a=d(a);c=this.by?d(this.by):y(a,function(f,h){return f-e[h]});this.from=e;this.to=a;this.by=c;this.unit=""},getValue:function(){var a=M(this.el,this.attr);return this.parseColor(a)},setValue:function(a){if(typeof a=="string"){S(this.el,this.attr,a)}else{S(this.el,this.attr,"rgb("+a.join(",")+")")}},action:function(a){var c=this;var b=this.from.map(function(e,d){return Math.max(Math.floor(e+c.easing(a,c.by[d])),0)});this.setValue(b)}},true);var N={"color$":P,"^scroll":I,"width$|height$|top$|bottom$|left$|right$":H,easing:null,".*":F};function R(a,d){for(var b in a){var c=new RegExp(b,"i");if(c.test(d)){return a[b]}}return null}var O=A(function(f,a,b,d){f=B(f);if(!E(f)){throw new Error(["Animation","Initialize Error","Element Not Found!"])}d=d||function(i,h){return h*i};this.options=a;var c=[];var e=function(i){for(var h=0;h<c.length;h++){c[h].action(i)}};this.agents=c;O.$super.call(this,e,b);this.on("beforestart",function(h){for(var i in a){var j=R(N,i);agent=new j(f,a[i],i,h.target);agent.easing=agent.easing||d;c.push(agent)}});this.on("end",function(j){for(var i=0;i<c.length;i++){var h=c[i];if(h&&h.finished){h.finished()}}})},g);O.agentHooks={show:function(c,b,d,a){z(d);return{from:0,to:M(d,b)}},hide:function(c,b,e,d){var a=M(e,b);d.on("end",function(){S(e,b,a);L(e)});return{from:a,to:0}},toggle:function(c,b,d,a){if(!D(d)){return O.agentHooks.show.apply(this,arguments)}else{return O.agentHooks.hide.apply(this,arguments)}},_default:function(c,b,e,a){var d=c.split(/\s+/g);if(d.length>=2){return{from:d[0],to:d[1]}}else{return{to:d[0]}}}};QW.provide("ElAnim",O)})();