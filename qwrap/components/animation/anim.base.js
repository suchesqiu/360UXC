(function(){var g=QW.CustEvent,j=QW.ObjectH.mix;var f=function(a,c,b){j(this,b);j(this,{action:a,dur:c!=null?c:400,_timeStamp:new Date()});g.createEvents(this,ANIM_EVENTS)};ANIM_EVENTS=["beforestart","enterframe","pause","resume","end","reset"];function h(a){if(a._requestID!=null){window.cancelRequestAnimationFrame(a._requestID);a._requestID=null}}function i(a,c,e,b){if(a._requestID==null){if(null==c){c=0}if(null==e){e=1}a.per=c;a._timeStamp=new Date()-a.per*a.dur;var d=function(l){if(a.per>=e){h(a);a.fire("end")}else{a.per=Math.min(1,(l-a._timeStamp)/a.dur);if(a.fire("enterframe")!==false){a.action(a.per)}a._requestID=window.requestAnimationFrame(d)}};if(a.fire("enterframe")!==false){a.action(a.per)}if(b){d(new Date())}else{a._requestID=window.requestAnimationFrame(d)}}}j(f.prototype,{start:function(){h(this);this.fire("beforestart");i(this);return true},reset:function(){h(this);i(this,0,0,true);this.fire("reset");return true},pause:function(){if(this._requestID){h(this);this.fire("pause");return true}return false},resume:function(){if(!this._requestID&&this.per&&this.per<1){this.fire("resume");i(this,this.per);return true}return false},cancel:function(){this.resume();if(this._requestID!=null){h(this);i(this,1,1,true);return true}return false}});QW.provide("Anim",f)})();