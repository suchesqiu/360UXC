Suggest.Data=function(b){Suggest._argValid(b,"object",arguments.callee);this._config={dataUrl:null,dataType:"ScriptCallBack",dataCallBack:Suggest.O,dataHandler:Suggest.O,dataCapacity:-1,callback:"callback",keyword:"keyword"};this._prop={key:"",index:-1,originalIndex:-1,cache:null,data:[]};QW.ObjectH.mix(this._config,b,true);return this._init()};Suggest.Data._EVENT=["datachange","indexchange","overflow"];Suggest.Data._UID={};Suggest.Data.prototype={_init:function(){var d=this.get("dataType");if(this.get("dataUrl")!=""){if(d=="ScriptCallBack"){var c=this.get("dataUrl")+"&max_count="+this.get("dataCapacity");this.set("dataUrl",c)}if(d=="ScriptData"){}}return this._initCache()&&this._initEvent()},_initCache:function(){var b=new Suggest.Cache(this._config);if(!b){Suggest._debug("arg","cacheCapacity",arguments.callee);return false}this._prop.cache=this.set("cache",b);return true},_initEvent:function(){return QW.CustEvent.createEvents(this,Suggest.Data._EVENT)},_dispatch:function(c){if(!QW.ArrayH.contains(Suggest.Data._EVENT,c)){Suggest._debug("arg",'event type "'+c.toString()+'" not exist',this);return false}var d=new QW.CustEvent(this,c);d.suggestData=this;this.fire(d)},query:function(d,c){if(!Suggest._argValid(d,"string",arguments.callee)){return false}this._prop.key=d;if(this._prop.cache.hasCache(d)){this._read(this._prop.cache.getCache(d));if(c){c.apply(this)}return true}else{return this._request(this.get("dataCallback"))}},_request:function(h){var i=0;do{i=(Math.random()*100000000).toFixed(0)}while(Suggest.Data._UID[i]!==window.undefined);Suggest.Data._UID[i]="";if(this.get("dataType")=="ScriptCallBack"){var j=document.getElementsByTagName("head")[0];var f=document.createElement("script");var g=false;f.src=this.get("dataUrl")+"&"+this._config.keyword+"="+window.encodeURIComponent(QW.StringH.trim(this._prop.key))+"&"+this._config.callback+"=_SuggestCallBack"+i;window["_SuggestCallBack"+i]=this._scriptCallbackHandler(this._prop.key);if(Suggest._argValid(h,"function",arguments.callee)){f.onload=f.onreadystatechange=function(){if(!g&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){g=true;h()}}}j.appendChild(f);return true}},_scriptCallbackHandler:function(f){var e=this;var d=this.get("dataHandler");return function(a){d(f,a,e)}},_read:function(b){if(b.length!==undefined){this._prop.data=b;this._dispatch("datachange");return true}else{Suggest._debug("arg","aDataSource must be an array",b);return false}},set:function(c,d){this._config[c]=d;return d},get:function(b){return this._config[b]},setCurrent:function(b){if(!Suggest._argValid(b,"number",arguments.callee)){return false}if(b>this.getLength()){Suggest._debug("arg","index setted is larger than the length of data",arguments.callee);return false}this._prop.originalIndex=this._prop.index;this._prop.index=b;this._dispatch("indexchange");return true},getData:function(){return this._prop.data},getOriginalIndex:function(){return this._prop.originalIndex},getIndex:function(){return this._prop.index},getItem:function(b){if(!Suggest._argValid(b,"number",arguments.callee)){return false}if(b>this.getLength()-1){return false}return this._prop.data[b]},getLength:function(){return this._prop.data.length},increase:function(d,f){var e=this.get("dataUrl");e.replace(/&max_count=([^&]*)/gi,function(a,b){return"&max_count="+(parseInt(b,10)+d)});return this._request(f)}};