Suggest.UI.ListView=function(b){Suggest._argValid(b,"object",arguments.callee);this._config={uiTemplate:"",uiListContainer:null,uiRender:null,uiHighlighter:Suggest.O,uiItemNumber:-1,uiStyle:{containerClass:"",selectClass:"",focusClass:""}};this._prop={container:null,items:[],start:0};QW.ObjectH.mix(this._config,b,true);return this._init()};Suggest.UI.ListView._EVENT=["itemfocus","itemblur","itemselect"];Suggest.UI.ListView.prototype={_init:function(){this._prop.container=this.get("uiListContainer")||QW.NodeW(document.createElement("div"));this._initEvent();return true},_initEvent:function(){QW.CustEvent.createEvents(this,Suggest.UI.ListView._EVENT);return true},_dispatch:function(f,e){if(!QW.ArrayH.contains(Suggest.UI.ListView._EVENT,f)){Suggest._debug("arg",'event type "'+f.toString()+'" not exist',this);return false}var d=new QW.CustEvent(this._prop.items[e],f);d.itemIndex=e;this.fire(d)},set:function(c,d){this._config[c]=d;return d},get:function(b){return this._config[b]},getContainer:function(){return this._prop.container},render:function(h){for(var g=0;g<this._prop.items.length;g++){this._prop.items[g].un()}this._prop.items.length=0;this._prop.start=0;this._prop.container.set("innerHTML","");for(var g=0,f=h.length;g<f;g++){this._prop.items[g]=this.renderItem(h[g],g);this.highlight(g);this._prop.container.appendChild(this._prop.items[g])}var e=this.get("uiItemNumber")==-1?this._prop.items.length:this.get("uiItemNumber");for(var g=e;g<this._prop.items.length;g++){this._prop.container.removeChild(this._prop.items[g])}},renderItem:function(i,h){var j=this.get("uiTemplate");var k=this.get("uiRender");var g=null;if(k!=QW.Suggest.O){g=QW.NodeW(k.apply(this,[i]))}else{if(j!=""){var l=j.replace(/\{([^\}]+)\}/gi,function(a,b){return i[b]||("{"+b+" }")});g=QW.NodeW(QW.DomU.create(l));g.addClass("item")}}this._bindEventToItem(g,h,i);return g},_bindEventToItem:function(e,f,g){var h=this;if(this.get("uiSelectFilter")(g)){e.on("mouseover",function(a){h.focusItem(f)});e.on("mouseout",function(a){h.blurItem(f)});e.on("mousedown",function(a){h._dispatch("itemselect",f)})}else{e.on("mousedown",function(a){a.preventDefault()})}},scrollDown:function(){if(this._prop.start===0){return}this._prop.items[this._prop.start].insertSiblingBefore(this._prop.items[this._prop.start-1]);this._prop.container.removeChild(this._prop.items[this._prop.start+this.get("uiItemNumber")-1]);this._prop.start--},scrollUp:function(){this._prop.container.removeChild(this._prop.items[this._prop.start]);this._prop.items[this._prop.start+this.get("uiItemNumber")-1].insertSiblingAfter(this._prop.items[this._prop.start+this.get("uiItemNumber")]);this._prop.start++},scrollTo:function(b){while(b<this._prop.start||b>this._prop.start+this.get("uiItemNumber")-1){if(this._prop.start>b){this.scrollDown()}if(this._prop.start+this.get("uiItemNumber")-1<b){this.scrollUp()}}},getItem:function(b){return this._prop.items[b]},selectItem:function(b){this._prop.items[b].addClass(this.get("uiStyle").selectClass);return true},focusItem:function(b){b=parseInt(b,10);if(b<0){return false}this.scrollTo(b);this._prop.items[b].addClass(this.get("uiStyle").focusClass);return true},highlight:function(d){d=parseInt(d,10);if(d<0){return false}var c=this.get("uiHighlighter");c(this._prop.items[d],d);return true},blurItem:function(b){b=parseInt(b,10);if(b<0){return false}this._prop.items[b].removeClass(this.get("uiStyle").focusClass);return true}};