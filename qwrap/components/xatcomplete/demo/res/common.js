window.MAX_INDEX=9999;function getMaxIndex(){window.MAX_INDEX=window.MAX_INDEX||9999;return ++window.MAX_INDEX}function getId(b){return typeof b==="string"?document.getElementById(b):b}function del_url_param(o,l){var m="";if(o.indexOf("#")>-1){m=o.split("#")[1];o=o.split("#")[0]}if(o.indexOf("?")>-1){var k=o.split("?")[1];var o=o.split("?")[0];var n=k.split("&");var j=[];for(var p=0;p<n.length;p++){var i=n[p].split("=");i[0]=i[0].replace(/^\s+|\s+$/g,"");if(i[0].toLowerCase()==l.toLowerCase()){continue}j.push(i.join("="))}o+="?"+j.join("&")}if(m){o+="#"+m}return o}function add_url_param(e,f){var d="";if(e.indexOf("#")>-1){d=e.split("#")[1];e=e.split("#")[0]}e=del_url_param(e,f.key);if(e.indexOf("?")>-1){e+="&"+f.key+"="+f.value}else{e+="?"+f.key+"="+f.value}if(d){e+="#"+d}e=e.replace(/\?\&/g,"?");return e}function XAppendScript(e,f){var d=document.createElement("script");d.src=e;if(!f){f=document.body}f.appendChild(d);return d}function attach_event_f(g,f,h,e){if(document.addEventListener){g.addEventListener(f,h,e)}else{if(document.attachEvent){f="on"+f;if(g[f]==null){g[f]=h}else{g.attachEvent(f,h)}}}}function keycode_f(b){b=b||window.event;return{keyCode:b.keyCode||b.which,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,altKey:b.altKey}}function ele_pos_f(i){var k=[],j=i.offsetTop,l=i.offsetLeft,a=i.offsetWidth,h=i.offsetHeight;while(i=i.offsetParent){j+=i.offsetTop;l+=i.offsetLeft}return{top:j,left:l,width:a,height:h}}function get_cursor(h){var i=0;if(typeof h.selectionStart=="number"&&typeof h.selectionEnd=="number"){i=h.selectionStart}else{if(document.selection){var g=document.selection.createRange();if(g.parentElement()==h){var j=document.body.createTextRange();j.moveToElementText(h);for(i=0;j.compareEndPoints("StartToStart",g)<0;i++){j.moveStart("character",1)}for(var f=0;f<=i;f++){if(h.value.charAt(f)=="\n"){i++}}}}}return i}function set_cursor(t,m){if(t.setSelectionRange){t.focus();t.setSelectionRange(m,m)}else{if(t.createTextRange){var i=t.createTextRange();var r=m;var o=m;var s=0;var q=0;var c=t.value;for(var p=0;p<c.length&&p<r;p++){var n=c.charAt(p);if(n!="\n"){s++}}for(var p=c.length-1;p>=o&&p>=0;p--){var n=c.charAt(p);if(n!="\n"){q++}}i.moveStart("character",s);i.moveEnd("character",-q);i.select();t.focus()}}}function stopPropagation(b){b=b||window.event;if(b.preventDefault){b.stopPropagation()}else{b.cancelBubble=false}}function preventDefault(b){b=b||window.event;if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}}function AddClass(c,d){KillClass(c,d);return c&&(c.className+=(c.className.length>0?" ":"")+d)}function KillClass(c,d){return c&&(c.className=c.className.replace(new RegExp("^"+d+"\\b\\s*|\\s*\\b"+d+"\\b","g"),""))}function HasClass(c,d){return(!c||!c.className)?false:(new RegExp("\\b"+d+"\\b")).test(c.className)}function style_f(g,f){var h="",e=!!window.ActiveXObject;if(e){h=g.currentStyle[f]}else{h=getComputedStyle(g)[f]}return h};