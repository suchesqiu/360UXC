(function(){var i=QW.ObjectH.mix,n=QW.ArrayH.remove,s=QW.StringH.format,A=QW.Browser.ie6,u=QW.DomU,m=u.createElement,r=u.getDocRect,v=QW.NodeH,d=QW.EventTargetH.addEventListener,j=QW.EventTargetH.removeEventListener,x=v.fire,g=v.hide,z=v.setStyle,w=v.getXY,l=function(G,E,F,D,C){var B=u.getDocRect();if(D==null){D=(B.width-E)/2+B.scrollX}D=Math.max(Math.min(D,B.scrollX+B.width-E),B.scrollX);if(C==null){C=(B.height-F)/2+B.scrollY}C=Math.max(Math.min(C,B.scrollY+B.height-F),B.scrollY);v.setXY(G,D,C)},c=v.contains,p=v.removeNode,f=QW.EventH,y=f.getTarget,b=f.getKeyCode,a=f.preventDefault,h=QW.CustEvent;var o={VERSION:"0.0.1"};(function(){var H=100;var B=[];var G,F=0;function E(){var I=m("div",{className:"mask",tabIndex:-1,unselectable:"on"});if(A){I.innerHTML='<div unselectable="on"></div><iframe src="'+o.bgIframeSrc+'"></iframe>'}document.body.insertBefore(I,document.body.firstChild);return I}function D(){var J=G.offsetParent,K=document.documentElement,I=G.style;if(parseInt(I.top)!=J.scrollTop||parseInt(I.left)!=J.scrollLeft){I.top=J.scrollTop;I.left=J.scrollLeft}if(K.clientHeight!=G.offsetHeight){I.height=K.clientHeight}if(K.clientWidth!=G.offsetWidth){I.width=K.clientWidth}}function C(I){if(I.keyEsc){j(document,"keydown",o.keydownHdl);d(document,"keydown",o.keydownHdl)}}i(o,{showPanel:function(I,Q,P,R,N,L){if(I._rendered){I.render()}n(B,I);B.push(I);var J=I.oWrap.style;if(I.isVisible){if(J.zIndex!=H){J.zIndex=(H+=2)}}else{J.zIndex=(H+=2)}if(I.withMask){G=G||E();z(G,{zIndex:H-1,display:"block"});if(A){D(G);clearInterval(F);F=setInterval(D,1000)}}if(R!=null){J.width=R+"px"}if(N!=null){J.height=N+"px"}if(I.posCenter){var K=o.getWrapSize(I);l(I.oWrap,K[0],K[1],Q,P)}else{Q=Q||0;P=P||0;if(L){var S=w(L);Q+=S[0];P+=S[1]}if(I.posAdjust){var K=o.getWrapSize(I);var O=r();Q=Math.min(Q,O.scrollX+O.width-K[0]);Q=Math.max(Q,O.scrollX);P=Math.min(P,O.scrollY+O.height-K[1]);P=Math.max(P,O.scrollY)}J.left=Q+"px";J.top=P+"px"}if((I.posAdjust||I.posCenter)&&B.length>1){var M=B[B.length-2].oWrap.style;if(M.top==J.top&&M.left==J.left){J.top=(parseInt(J.top)+10)+"px";J.left=(parseInt(J.left)+10)+"px"}}J.display="block";I.isVisible=true;C(I)},hidePanel:function(I){g(I.oWrap);I.isVisible=false;n(B,I);var L=false;for(var K=B.length-1;K>-1;K--){var J=B[K];if(J.withMask){L=true;G.style.zIndex=J.oWrap.style.zIndex-1;break}}if(!L&&G){g(G);clearInterval(F)}},disposePanel:function(I){p(I.oWrap);for(var J in I){I[J]=null}},risePanel:function(I){if(I.isVisible){var J=I.oWrap.style;if(J.zIndex!=H){J.zIndex=(H+=2);n(B,I);B.push(I);if(I.withMask){var K=G.style;K.zIndex=H-1}}}else{alert("程序错误.");throw"错误：还没有打开panel呢."}},keydownHdl:function(J){if(B.length&&b(J)==27){var I=B[B.length-1];if(I.keyEsc){I.hide();a(J)}}if(!B.length){j(document,"keydown",o.keydownHdl)}},getWrapSize:function(M,L,I){var J=M.oWrap,O=J.style;var K=[O.display,O.width,O.height];O.display="block";if(L){O.width=L}if(I){O.height=I}var N=[J.offsetWidth,J.offsetHeight];O.display=K[0];if(K[1]){O.width=K[1]}if(K[2]){O.height=K[2]}return N},bgIframeSrc:"about:blank"})}());function t(B){i(this,B,1);if(!this.lazyRender){this.render()}return this}(function(){t.EVENTS=["beforeshow","aftershow","beforehide","afterhide"];function B(C,D){D=D||"";if(D.tagName){C.innerHTML="";C.appendChild(D)}else{C.innerHTML=D}}t._elHtml={content:'<div class="panel-content" remark="oContent"><div class="hd"></div><div class="bd"></div><div class="ft"></div></div>',closeHdl:'<span class="close"></span>',resizeHdl:'<span class="resize"><span></span></span>',corner1:'<span class="co1"><span></span></span>',corner2:'<span class="co2"><span></span></span>',cue:'<span class="cue"></span>',shadow:'<span class="sd"></span>',bgIframe:'<iframe class="panel-iframe" src="'+o.bgIframeSrc+'" FRAMEBORDER=0 height="100%"></iframe>'};t.prototype={defaultClassName:"panel",wrapId:"",className:"",title:"",header:"",body:"Panel Body",footer:"",withCorner:0,withCue:0,withShadow:0,withClose:0,withBgIframe:A,withMask:0,dragable:0,resizable:0,keyEsc:0,posCenter:0,posAdjust:0,isVisible:false,oWrap:null,oContent:null,oHeader:null,oBody:null,oFooter:null,oCloseHdl:null,oResizeHdl:null,oShadow:null,oCue:null,oCorner1:null,oCorner2:null,oBgIframe:null,render:function(){var H=this;if(H._rendered){return}var I=m("div",{className:H.defaultClassName+" "+(H.className||"")});I.style.display="none";H.oWrap=I;if(H.wrapId){I.id=H.wrapId}g(I);var D=t._elHtml;var G=[D.content,H.withClose?D.closeHdl:"",H.resizable?D.resizeHdl:"",H.withCorner?(D.corner1+D.corner2):"",H.withCue?D.cue:"",H.withShadow?D.shadow:"",(H.withBgIframe&&A)?D.bgIframe:""];I.innerHTML=G.join("");var F=I.childNodes;H.oContent=F[0];var E=1;if(H.withClose){H.oCloseHdl=F[E++]}if(H.resizable){H.oResizeHdl=F[E++]}if(H.withCorner){H.oCorner1=F[E++];H.oCorner2=F[E++]}if(H.withCue){H.oCue=F[E++]}if(H.withShadow){H.oShadow=F[E++]}if(H.withBgIframe&&A){H.oBgIframe=F[E++]}var F=H.oContent.childNodes;H.oHeader=F[0];H.oBody=F[1];H.oFooter=F[2];H.isVisible=false;var C=(H.title&&"<h3>"+H.title+"</h3>")||H.header;if(C){B(H.oHeader,C)}if(H.body){B(H.oBody,H.body)}if(H.footer){B(H.oFooter,H.footer)}if(H.withClose){d(H.oCloseHdl,"click",function(){H.hide()})}if(H.dragable){H.initDrag()}if(H.resizable){H.initResize()}document.body.insertBefore(I,document.body.firstChild);h.createEvents(H,t.EVENTS);H._rendered=true},show:function(D,C,E,G,F){if(this._rendered){this.render()}if(this.fire("beforeshow")==false){return false}o.showPanel(this,D,C,E,G,F);this.fire("aftershow");return true},hide:function(){if(this.fire("beforehide")==false){return false}o.hidePanel(this);this.fire("afterhide");return true},dispose:function(){if(this.isVisible){return false}else{o.disposePanel(this)}},rise:function(){o.risePanel(this)},initDrag:function(){var D=this;var C=new QW.SimpleDrag({oSrc:this.oWrap,oHdl:this.oHeader,minXAttr:1,minYAttr:1,withProxy:true});C.on("dragstart",function(){D.rise()})},initResize:function(){var D=this;var C=new QW.SimpleResize({oSrc:this.oWrap,oHdl:this.oResizeHdl,minXAttr:150,yFixed:true,withProxy:true});C.on("dragstart",function(){D.rise()})}}}());function e(B){i(this,B,1);if(!this.lazyRender){this.render()}return this}(function(){e.MENTOR_CLASS=t;e.prototype={posAdjust:1,defaultClassName:"panel panel-popup",relatedEls:null,_refreshBlurHdl:function(B){if(this._fnBlur){j(document,"keydown",this._fnBlur);j(document,"keyup",this._fnBlur);j(document,"mousedown",this._fnBlur);if(B){d(document,"keydown",this._fnBlur);d(document,"keyup",this._fnBlur);d(document,"mousedown",this._fnBlur)}}},show:function(D,C,E,G,F){var B=this;if(B._rendered){B.render()}B._fnBlur=B._fnBlur||function(K){var J=y(K)||document.body;if(!B.oWrap){return}var L=B.relatedEls||[];L.push(B.oWrap);for(var I=0;I<L.length;I++){var H=L[I];if(H==J||c(H,J)){return}}B.hide()};if(B.fire("beforeshow")==false){return false}o.showPanel(B,D,C,E,G,F);B._refreshBlurHdl(true);B.fire("aftershow");return true},hide:function(){if(this.fire("beforehide")==false){return false}o.hidePanel(this);this._refreshBlurHdl(false);this.fire("afterhide");return true},setContent:function(B){}};i(e.prototype,t.prototype)}());function k(B){i(this,B,1);if(!this.lazyRender){this.render()}return this}(function(){k.MENTOR_CLASS=t;k.prototype={defaultClassName:"panel panel-dialog",withMask:1,withClose:1,dragable:!!QW.SimpleDrag};i(k.prototype,t.prototype)}());var q=(function(){var B={alert:'<div class="panel-dialog-sys panel-alert cls"><div class="msg">{0}</div><div class="btn-ctn"><button>确定</button></div></div>',confirm:'<div class="panel-dialog-sys panel-confirm cls"><div class="msg">{0}</div><div class="btn-ctn"><button>确定</button><button>取消</button></div></div>',prompt:'<div class="panel-dialog-sys panel-prompt cls"><div class="msg">{0}</div><div class="ipt-ctn"><input type="text-input"></div><div class="btn-ctn"><button>确定</button><button>取消</button></div></div>',msgbox:'<div class="panel-dialog-sys panel-msgbox cls"><div class="msg">{0}</div><div class="btn-ctn"><button>是(Yes)</button><button>否(No)</button><button>取消</button></div></div>'};var C={getSysDialog:function(F,I,J,H){H=H||{};i(H,{posCenter:1,keyEsc:1,title:"系统提示",dragable:!!QW.SimpleDrag,body:s(B[F]||"error",I)});var D=new k(H);var G=D.oWrap.getElementsByTagName("button");D.dialogButtons=G;switch(F){case"alert":d(G[0],"click",function(K){D.hide()});break;case"confirm":d(G[0],"click",function(K){D.returnValue=true;D.hide()});d(G[1],"click",function(K){D.hide()});D.returnValue=false;break;case"prompt":var E=D.oWrap.getElementsByTagName("input")[0];D.dialogInput=E;d(E,"keydown",function(K){if(b(K)==f.KEY_ENTER){setTimeout(function(){x(G[0],"click")},10)}});d(G[0],"click",function(K){D.returnValue=E.value;D.hide()});d(G[1],"click",function(K){D.hide()});break;case"msgbox":d(G[0],"click",function(K){D.returnValue=true;D.hide()});d(G[1],"click",function(K){D.returnValue=false;D.hide()});d(G[2],"click",function(K){D.hide()});break}D.on("aftershow",function(){var L=(E||G[0]);try{L.focus();L.select()}catch(K){}});D.on("afterhide",function(){try{J&&J(this.returnValue)}finally{}});return D},_sysDialog:function(E,H,D,I,F){F=F||{};var G=QW.Panel.getSysDialog(E,H,I,F);if(E=="prompt"){G.dialogInput.value=D||""}G.show(null,null,F.width||300,F.height)},alert:function(E,F,D){QW.Panel._sysDialog("alert",E,null,F,D)},confirm:function(E,F,D){QW.Panel._sysDialog("confirm",E,null,F,D)},prompt:function(F,D,G,E){QW.Panel._sysDialog("prompt",F,D,G,E)},msgbox:function(E,F,D){QW.Panel._sysDialog("msgbox",E,null,F,D)}};return C}());QW.provide({PanelManager:o,BasePanel:t,LayerPopup:e,LayerDialog:k,Panel:q})}());