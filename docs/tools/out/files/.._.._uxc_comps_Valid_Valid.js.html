<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../../uxc/comps/Valid/Valid.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/UXC.html">UXC</a></li>
            
                <li><a href="../classes/Valid.html">Valid</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../../uxc/comps/Valid/Valid.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
(function($){
    !window.UXC &amp;&amp; (window.UXC = { log:function(){} });
    window.Valid = UXC.Valid = Valid;
    /**
     * 表单验证
     * @class Valid
     * @constructor
     * @global
     * @alias UXC.Valid 
     * @alias window.Valid
     * @classdesc 
     *      全局访问请使用 UXC.Valid 或 Valid&lt;br /&gt;
     * @requires jQuery
     * @version dev 0.1
     * @author  qiushaowei   &lt;suches@btbtd.org&gt; | {@link http://uxc.360.cn|360 UXC-FE Team}
     * @date    2013-05-22
     */
    function Valid(){}
    /**
     * 验证一个表单项, 如 文本框, 下拉框, 复选框, 单选框, 文本域, 隐藏域
     * @method check
     * @param      {elements}    _item -   需要验证规则正确与否的表单/表单项
     * @example 
     *          UXC.Valid.check( $(&#x27;input.needValid&#x27;) );
     *          UXC.Valid.check( document.getElementById(&#x27;inputNeedValid&#x27;) );
     *
     *          if( !UXC.Valid.check( $(&#x27;form&#x27;) ) ){
     *              _evt.preventDefault();
     *              return false;
     *          }
     * @return    {boolean}
     */
    Valid.check =  
        function( _item ){ 
            var _r = true, _item = $(_item), _type = _item.length ? _item.prop(&#x27;nodeName&#x27;).toLowerCase() : &#x27;&#x27;;
            if( _item.length ){
                if( _type == &#x27;form&#x27; ){
                    $( _item[0].elements ).each( function(){
                        !_logic.parse( $(this) ) &amp;&amp; ( _r = false );
                    });
                } else _r = _logic.parse( _item );
            }
            return _r;
        };
    /**
     * 这个方法是 {@link Valid.check} 的别名
     * @method checkAll
     * @param      {elements}    _item -   需要验证规则正确与否的表单/表单项
     * @see Valid.check
     */
    Valid.checkAll = Valid.check;
     /**
     * 清除Valid生成的错误样式
     * @method clearError
     * @param   {form|input|textarea|select|file|password}  _selector -     需要清除错误的选择器
     * @example
     *          UXC.Valid.clearError( &#x27;form&#x27; );
     *          UXC.Valid.clearError( &#x27;input.some&#x27; );
     */
    Valid.clearError = 
        function( _selector ){
            $( _selector ).each( function(){
                var _item = $(this);
                UXC.log( &#x27;clearError: &#x27; + _item.prop(&#x27;nodeName&#x27;) );
                switch( _item.prop(&#x27;nodeName&#x27;).toLowerCase() ){
                    case &#x27;form&#x27;: 
                        {
                            $( _item[0].elements ).each( function(){
                                if( $(this).is(&#x27;[disabled]&#x27;) ) return;
                                _logic.valid( $(this) );
                            });

                            break;
                        }
                    default: _logic.valid( $(this) ); break;
                }
            });
        };
    /**
     * 响应表单子对象的 blur事件, 触发事件时, 检测并显示错误或正确的视觉效果
     * @private
     */
    $(document).delegate( &#x27;input[type=TEXT], input[type=PASSWORD], textarea&#x27;, &#x27;blur&#x27;, function($evt){
        UXC.Valid.check( this )
    });
    /**
     * 响应表单子对象的 change 事件, 触发事件时, 检测并显示错误或正确的视觉效果
     * @private
     */
    $(document).delegate( &#x27;select, input[type=file]&#x27;, &#x27;change&#x27;, function($evt){
        UXC.Valid.check( this )
    });
    /**
     * 私有逻辑处理对象, 验证所需的所有规则和方法都存放于此对象
     * @private
     */
    var _logic =
        {
            /**
             * 分析_item是否附合规则要求
             * @param   {selector}  _item 
             */
            parse: 
                function( _item ){

                    var _r = true, _item = $(_item);

                    _item.each( function(){

                        if( !_logic.isValidItem(this) ) return;
                        var _sitem = $(this), _dt = _logic.getDatatype( _sitem ), _subdt = _logic.getSubdatatype( _sitem );

                        if( _sitem.is(&#x27;[disabled]&#x27;) ) return;

                        UXC.log( _dt, _subdt );

                        if( _sitem.is(&#x27;[reqmsg]&#x27;) ){
                            if( ! _logic.datatype[&#x27;reqmsg&#x27;]( _sitem ) ) {
                                _r = false;
                                return;
                             }
                        }

                        if( !_logic.datatype[&#x27;length&#x27;]( _sitem ) ){
                            _r = false;
                            return;
                        }

                        if( _dt in _logic.datatype &amp;&amp; _sitem.val() ){
                            if( !_logic.datatype[ _dt ]( _sitem ) ){
                                _r = false;
                                return;
                            }
                        }
                        
                        if( _subdt &amp;&amp; _subdt in _logic.subdatatype &amp;&amp; ( _sitem.val() || _subdt == &#x27;alternative&#x27; ) ){
                            if( !_logic.subdatatype[ _subdt ]( _sitem ) ){
                                _r = false;
                                return;
                            }
                        }

                        _logic.valid( _sitem );
                    });

                    return _r;
                }
            /**
             * 检测 _item 是否为 Valid 的检测对象
             * @param   {selector}  _item
             */
            , isValidItem: 
                function( _item ){
                    _item = $(_item);
                    var _r, _tmp;

                    _item.each( function(){
                        _tmp = $(this);
                        if( _tmp.is( &#x27;[datatype]&#x27; ) || _tmp.is( &#x27;[subdatatype]&#x27; ) 
                            || _tmp.is( &#x27;[minlength]&#x27; ) || _tmp.is( &#x27;[maxlength]&#x27; )  
                            || _tmp.is( &#x27;[reqmsg]&#x27; ) ) 
                            _r = true;
                    });

                    return _r;
                }
            /**
             * 显示正确的视觉效果
             * @param   {selector}  _item
             */
            , valid:
                function( _item ){
                    if( !_logic.isValidItem( _item ) ) return;
                    _item.removeClass(&#x27;error&#x27;);
                    _item.find(&#x27;~ em&#x27;).show();
                    _item.find(&#x27;~ em.error&#x27;).hide();
                }
            /**
             * 显示错误的视觉效果
             * @param   {selector}  _item
             */
            , error: 
                function( _item, _msgAttr, _fullMsg ){
                    if( !_logic.isValidItem( _item ) ) return;

                    var _msg = _logic.getMsg.apply( null, [].slice.call( arguments ) ), _errEm;

                    _item.addClass( &#x27;error&#x27; );
                    _item.find(&#x27;~ em:not(.error)&#x27;).hide();

                    if( _item.is( &#x27;[emEl]&#x27; ) ){
                        ( _errEm = _logic.getElement( _item.attr( &#x27;emEl&#x27; ) ) ) &amp;&amp; _errEm.length &amp;&amp; _errEm.addClass(&#x27;error&#x27;);
                    }
                    !( _errEm &amp;&amp; _errEm.length ) &amp;&amp; ( _errEm = _item.find(&#x27;~ em.error&#x27;) );
                    if( !_errEm.length ){
                        ( _errEm = $(&#x27;&lt;em class=&quot;error&quot;&gt;&lt;/em&gt;&#x27;) ).insertAfter( _item );
                    }
                    UXC.log( &#x27;error: &#x27; + _msg );
                    _errEm.html( _msg ).show() 

                    return false;
                }
            /**
             * 获取 _selector 对象
             * 这个方法的存在是为了向后兼容qwrap, qwrap DOM参数都为ID
             * @param   {selector}  _item
             */
            , getElement: 
                function( _item ){
                    if( /^[\w-]+$/.test( _item ) ) _item = &#x27;#&#x27; + _item;
                    return $(_item );
                }
            /**
             * 获取 _item 的检测类型, 所有可用的检测类型位于 _logic.datatype 对象
             * @param   {selector}  _item
             */
            , getDatatype: 
                function( _item ){
                    return ( _item.attr(&#x27;datatype&#x27;) || &#x27;text&#x27;).toLowerCase().replace(/\-.*/, &#x27;&#x27;);
                }
           /**
             * 获取 _item 的检测子类型, 所有可用的检测子类型位于 _logic.subdatatype 对象
             * @param   {selector}  _item
             */
            , getSubdatatype: 
                function( _item ){
                    return ( _item.attr(&#x27;subdatatype&#x27;) || &#x27;text&#x27;).toLowerCase().replace(/\-.*/, &#x27;&#x27;);
                }
            /**
             * 获取对应的错误信息, 默认的错误信息有 reqmsg, errmsg, &lt;br /&gt;
             * 注意: 错误信息第一个字符如果为空格的话, 将完全使用用户定义的错误信息, 将不会动态添加 请上传/选择/填写
             * @param   {selector}  _item
             * @param   {string}    _msgAttr    - 显示指定需要读取的错误信息属性名, 默认为 reqmsg, errmsg, 通过该属性可以指定别的属性名
             * @param   {bool}      _fullMsg    - 显示指定错误信息为属性的值, 而不是自动添加的 请上传/选择/填写
             */
            , getMsg: 
                function( _item, _msgAttr, _fullMsg ){
                    var _msg = _item.is(&#x27;[errmsg]&#x27;) ? &#x27; &#x27; + _item.attr(&#x27;errmsg&#x27;) : _item.is(&#x27;[reqmsg]&#x27;) ? _item.attr(&#x27;reqmsg&#x27;) : &#x27;&#x27;;
                    _msgAttr &amp;&amp; (_msg = _item.attr( _msgAttr ) || _msg );
                    _fullMsg &amp;&amp; _msg &amp;&amp; ( _msg = &#x27; &#x27; + _msg );

                    if( _msg &amp;&amp; !/^[\s]/.test( _msg ) ){
                        switch( _item.prop(&#x27;type&#x27;).toLowerCase() ){
                            case &#x27;file&#x27;: _msg = &#x27;请上传&#x27; + _msg; break;

                            case &#x27;select-multiple&#x27;:
                            case &#x27;select-one&#x27;:
                            case &#x27;select&#x27;: _msg = &#x27;请选择&#x27; + _msg; break;

                            case &#x27;textarea&#x27;:
                            case &#x27;password&#x27;:
                            case &#x27;text&#x27;: _msg = &#x27;请填写&#x27; + _msg; break;
                        }
                    }

                    UXC.log( &#x27;_msg: &#x27; + _msg, _item.prop(&#x27;type&#x27;).toLowerCase() );

                    return _msg.trim();
                }
            /**
             * 计算字符串的字节长度, 非 ASCII 0-255的字符视为两个字节
             * @param   {string}    _s
             */
            , bytelen: 
                function( _s ){
                    return _s.replace(/[^\x00-\xff]/g,&quot;11&quot;).length;
                }
            /**
             * 获取日期字符串的 timestamp, 字符串格式为 YYYY[^\d]*?MM[^\d]*?DD
             * @param   {string}    _date_str
             */
            , getTimestamp:
                function( _date_str ){
                    _date_str = _date_str.replace( /[^\d]/g, &#x27;&#x27; );
                    return new Date( _date_str.slice(0,4), parseInt( _date_str.slice( 4, 6 ), 10 ) - 1, _date_str.slice( 6, 8) ).getTime();
                }
            /**
             * 此对象存储可供检测的子类型
             */
            , subdatatype: {
                /**
                 * 此类型检测 2|N个对象必须至少有一个是有输入内容的, 
                 * 常用于 手机/电话 二填一
                 * @param   {selector}  _item
                 * @example
                        &lt;dd&gt;
                        &lt;div class=&quot;f-l label&quot;&gt;
                            &lt;label&gt;(datatype phonezone, phonecode, phoneext)电话号码:&lt;/label&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;f-l&quot;&gt;
                            &lt;input type=&#x27;TEXT&#x27; name=&#x27;company_phonezone&#x27; style=&quot;width:40px;&quot; value=&#x27;&#x27; size=&quot;4&quot; 
                                datatype=&quot;phonezone&quot; emEl=&quot;#phone-err-em&quot; errmsg=&quot;请填写正确的电话区号&quot; /&gt;
                            - &lt;input type=&#x27;TEXT&#x27; name=&#x27;company_phonecode&#x27; style=&quot;width:80px;&quot; value=&#x27;&#x27; size=&quot;8&quot; 
                                datatype=&quot;phonecode&quot; subdatatype=&quot;alternative&quot; datatarget=&quot;input[name=company_mobile]&quot; alternativemsg=&quot;电话号码和手机号码至少填写一个&quot;
                                errmsg=&quot;请检查电话号码格式&quot; emEl=&quot;#phone-err-em&quot; /&gt;
                            - &lt;input type=&#x27;TEXT&#x27; name=&#x27;company_phoneext&#x27; style=&quot;width:40px;&quot; value=&#x27;&#x27; size=&quot;4&quot; 
                                datatype=&quot;phoneext&quot; emEl=&quot;#phone-err-em&quot; errmsg=&quot;请填写正确的分机号&quot; /&gt;
                            &lt;em id=&quot;phone-err-em&quot;&gt;&lt;/em&gt;
                        &lt;/div&gt;
                        &lt;/dd&gt;

                        &lt;dd&gt;
                        &lt;div class=&quot;f-l label&quot;&gt;
                            &lt;label&gt;(datatype mobilecode)手机号码:&lt;/label&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;f-l&quot;&gt;
                            &lt;input type=&quot;TEXT&quot; name=&quot;company_mobile&quot; 
                                datatype=&quot;mobilecode&quot; subdatatype=&quot;alternative&quot; datatarget=&quot;input[name=company_phonecode]&quot; alternativemsg=&quot; &quot;
                                errmsg=&quot;请填写正确的手机号码&quot;&gt;
                        &lt;/div&gt;
                        &lt;/dd&gt;
                 */
                alternative:
                    function( _item ){
                        var _r = true, _target;

                        UXC.log( &#x27;alternative&#x27; );

                        if( _item.is( &#x27;[datatarget]&#x27; ) &amp;&amp; (_target = $(_item.attr(&#x27;datatarget&#x27;)) ).length &amp;&amp; !_item.val() ){
                            var _hasVal = false;
                            _target.each( function(){ if( $(this).val() ){ _hasVal = true; return false; } } );
                            _r = _hasVal;
                        }

                        !_r &amp;&amp; _logic.error( _item, &#x27;alternativemsg&#x27;, true );
                        !_r &amp;&amp; _target.length &amp;&amp; _target.each( function(){ _logic.error( $(this), &#x27;alternativemsg&#x27;, true ); } );
                        _r &amp;&amp; _target.length &amp;&amp; _target.each( function(){ _logic.valid( $(this) ); } );

                        return _r;
                    }
                /**
                 * 此类型检测 2|N 个对象填写的值必须一致
                 * 常用于注意时密码验证/重置密码
                 * @param   {selector}  _item
                 * @example
                        &lt;dd&gt;
                        &lt;div class=&quot;f-l label&quot;&gt;
                            &lt;label&gt;(datatype text, subdatatype reconfirm)用户密码:&lt;/label&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;f-l&quot;&gt;
                            &lt;input type=&quot;PASSWORD&quot; name=&quot;company_pwd&quot; 
                            datatype=&quot;text&quot; subdatatype=&quot;reconfirm&quot; datatarget=&quot;input[name=company_repwd]&quot; reconfirmmsg=&quot;用户密码和确认密码不一致&quot;
                            minlength=&quot;6&quot; maxlength=&quot;15&quot; reqmsg=&quot;用户密码&quot; errmsg=&quot;请填写正确的用户密码&quot;&gt;
                        &lt;/div&gt;
                        &lt;/dd&gt;

                        &lt;dd&gt;
                        &lt;div class=&quot;f-l label&quot;&gt;
                            &lt;label&gt;(datatype text, subdatatype reconfirm)确认密码:&lt;/label&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;f-l&quot;&gt;
                            &lt;input type=&quot;PASSWORD&quot; name=&quot;company_repwd&quot; 
                            datatype=&quot;text&quot; subdatatype=&quot;reconfirm&quot; datatarget=&quot;input[name=company_pwd]&quot; reconfirmmsg=&quot;确认密码和用户密码不一致&quot;
                            minlength=&quot;6&quot; maxlength=&quot;15&quot; reqmsg=&quot;确认密码&quot; errmsg=&quot;请填写正确的确认密码&quot;&gt;
                        &lt;/div&gt;
                        &lt;/dd&gt;
                 */
                , reconfirm:
                    function( _item ){
                        var _r = true, _target;

                        UXC.log( &#x27;reconfirm&#x27; );

                        if( _item.is( &#x27;[datatarget]&#x27; ) &amp;&amp; (_target = $(_item.attr(&#x27;datatarget&#x27;)) ).length ){
                            _target.each( function(){ if( _item.val() != $(this).val() ) return _r = false; } );
                        }

                        !_r &amp;&amp; _logic.error( _item, &#x27;reconfirmmsg&#x27;, true );
                        !_r &amp;&amp; _target.length &amp;&amp; _target.each( function(){ _logic.error( $(this), &#x27;reconfirmmsg&#x27;, true ); } );
                        _r &amp;&amp; _target.length &amp;&amp; _target.each( function(){ _logic.valid( $(this) ); } );

                        return _r;
                    }

            }//subdatatype
            /**
             * 此对象存储可供检测的类型
             */
            , datatype:{
                /**
                 * 检测是否为正确的数字
                 * @param   {selector}  _item
                 * @attr    {require}               datatype    - n | n-整数位数.小数位数
                 * @attr    {integer|optional}      minvalue    - 数值的下限
                 * @attr    {integer|optional}      maxvalue    - 数值的上限
                 */
                n: 
                    function( _item ){
                        var _r = true, _valStr = _item.val(), _val = +_valStr,_min = 0, _max = Math.pow( 10, 10 ), _n, _f, _tmp;

                        if( !isNaN( _val ) &amp;&amp; _val &gt;= 0 ){
                            _item.attr(&#x27;datatype&#x27;).replace( /^n\-(.*)$/, function( $0, $1 ){
                                _tmp = $1.split(&#x27;.&#x27;);
                                _n = _tmp[0];
                                _f = _tmp[1];
                            });
                            if( _item.is(&#x27;[minvalue]&#x27;) ) _min = +_item.attr(&#x27;minvalue&#x27;) || _min;
                            if( _item.is(&#x27;[maxvalue]&#x27;) ) _max = +_item.attr(&#x27;maxvalue&#x27;) || _max;

                            if( _val &gt;= _min &amp;&amp; _val &lt;= _max ){
                                typeof _n != &#x27;undefined&#x27; &amp;&amp; typeof _f != &#x27;undefined&#x27; &amp;&amp; ( _r = new RegExp( &#x27;^(?:[\\d]{0,&#x27;+_n+&#x27;}|)(?:\\.[\\d]{1,&#x27;+_f+&#x27;}|)$&#x27; ).test( _valStr ) );
                                typeof _n != &#x27;undefined&#x27; &amp;&amp; typeof _f == &#x27;undefined&#x27; &amp;&amp; ( _r = new RegExp( &#x27;^[\\d]{1,&#x27;+_n+&#x27;}$&#x27; ).test( _valStr ) );
                                typeof _n == &#x27;undefined&#x27; &amp;&amp; typeof _f != &#x27;undefined&#x27; &amp;&amp; ( _r = new RegExp( &#x27;^\\.[\\d]{1,&#x27;+_f+&#x27;}$&#x27; ).test( _valStr ) );
                                typeof _f == &#x27;undefined&#x27; &amp;&amp; /\./.test( _valStr ) &amp;&amp; ( _r = false );
                            } else _r = false;

                            UXC.log( &#x27;nValid&#x27;, _val, typeof _n, typeof _f, typeof _min, typeof _max, _min, _max );
                        }else _r = false;

                        !_r &amp;&amp; _logic.error( _item );

                        return _r;
                    }
                /**
                 * 检测是否为合法的日期,
                 * 日期格式为 YYYYMMDD, YYYY/MM/DD, YYYY-MM-DD, YYYY.MM.DD
                 * @param   {selector}  _item
                 * @attr    {require}               datatype    - d
                 * @attr    {date string|optional}  minvalue    - 日期的下限
                 * @attr    {date string|optional}  maxvalue    - 日期的上限
                 */
                , d: 
                    function( _item ){
                        var _val = _item.val().trim(), _r, _re = /^[\d]{4}([\/.-]|)[01][\d]\1[0-3][\d]$/;
                        if( !_val ) return true;
                            
                        if( _r = _re.test( _val ) ){
                            var _utime = _logic.getTimestamp( _item.val() ), _minTime, _maxTime;

                            if( _item.is(&#x27;[minvalue]&#x27;) &amp;&amp; ( _r = _re.test( _item.attr(&#x27;minvalue&#x27;) ) ) ){
                                _minTime = _logic.getTimestamp( _item.attr(&#x27;minvalue&#x27;) );
                                _utime &lt; _minTime &amp;&amp; ( _r = false );
                            }

                            if( _r &amp;&amp; _item.is(&#x27;[maxvalue]&#x27;) &amp;&amp; ( _r = _re.test( _item.attr(&#x27;maxvalue&#x27;) ) ) ){
                                _maxTime = _logic.getTimestamp( _item.attr(&#x27;maxvalue&#x27;) );
                                _utime &gt; _maxTime &amp;&amp; ( _r = false );
                            }
                        }

                        !_r &amp;&amp; _logic.error( _item );

                        return _r;
                    }
                /**
                 * 检测两个输入框的日期
                 * 日期格式为 YYYYMMDD, YYYY/MM/DD, YYYY-MM-DD, YYYY.MM.DD
                 * @param   {selector}  _item
                 * @attr    {require}               datatype    - datarange
                 * @attr    {selector|optional}     fromDateEl  - 起始日期选择器
                 * @attr    {selector|optional}     toDateEl    - 结束日期选择器
                 * @attr    {date string|optional}  minvalue    - 日期的下限
                 * @attr    {date string|optional}  maxvalue    - 日期的上限
                 */
                , daterange:
                    function( _item ){
                        var _r = _logic.datatype.d( _item ), _mind, _maxd;

                        if( _r ){
                        
                            if( _r ){
                                var _fromDateEl, _toDateEl;
                                if( _item.is( &#x27;[fromDateEl]&#x27; ) ) _fromDateEl = _logic.getElement( _item.attr(&#x27;fromDateEl&#x27;) );
                                if( _item.is( &#x27;[toDateEl]&#x27; ) ) _toDateEl = _logic.getElement( _item.attr(&#x27;toDateEl&#x27;) );
                                if( _fromDateEl &amp;&amp; _fromDateEl.length || _toDateEl &amp;&amp; _toDateEl.length ){

                                    _fromDateEl &amp;&amp; _fromDateEl.length &amp;&amp; !( _toDateEl &amp;&amp; _toDateEl.length ) &amp;&amp; ( _toDateEl = _item );
                                    !(_fromDateEl &amp;&amp; _fromDateEl.length) &amp;&amp; _toDateEl &amp;&amp; _toDateEl.length &amp;&amp; ( _fromDateEl = _item );

                                    UXC.log( &#x27;daterange&#x27;, _fromDateEl.length, _toDateEl.length );

                                    if( _toDateEl[0] != _fromDateEl[0] ){


                                        _r &amp;&amp; ( _r = _logic.datatype.d( _toDateEl ) );
                                        _r &amp;&amp; ( _r = _logic.datatype.d( _fromDateEl ) );

                                        _r &amp;&amp; _logic.getTimestamp( _fromDateEl.val() ) &gt; _logic.getTimestamp( _toDateEl.val() ) &amp;&amp; ( _r = false );

                                        _r &amp;&amp; _logic.valid( _fromDateEl );
                                        _r &amp;&amp; _logic.valid( _toDateEl );

                                    }
                                }
                            }
                        }

                        !_r &amp;&amp; _logic.error( _item );

                        return _r;
                    }
                /**
                 * 检测时间格式, 格式为 mm:dd:ss
                 * @param   {selector}  _item
                 */
                , time: 
                    function( _item ){
                        var _r = /^(([0-1]\d)|(2[0-3])):[0-5]\d:[0-5]\d$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }
                /**
                 * 检测时间格式, 格式为 mm:dd:ss
                 * @param   {selector}  _item
                 */
                , minute: 
                    function( _item ){
                        var _r = /^(([0-1]\d)|(2[0-3])):[0-5]\d$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }


                , bankcard:
                    function( _item ){
                        var _r = /^[1-9][\d]{3}(?: |)(?:[\d]{4}(?: |))(?:[\d]{4}(?: |))(?:[\d]{4})(?:(?: |)[\d]{3}|)$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , cnname:
                    function( _item ){
                        var _r = _logic.bytelen( _item.val() ) &lt; 32 &amp;&amp; /^[\u4e00-\u9fa5a-zA-Z.\u3002\u2022]{2,32}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , username:
                    function( _item ){
                        var _r = /^[a-zA-Z0-9][\w-]{2,29}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , idnumber:
                    function( _item ){
                        var _r = /^[0-9]{15}(?:[0-9]{2}(?:[0-9xX]|)|)$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , mobilecode: 
                    function( _item ){
                        var _r =  /^(13|15|18|14)\d{9}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , mobilezonecode: 
                    function( _item ){
                        var _r = /^(?:\+[0-9]{1,6} |)(?:0|)(?:13|15|18|14)\d{9}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , phone:
                    function( _item ){
                        var _r = /^(?:0(?:10|2\d|[3-9]\d\d)(?: |\-|)|)[1-9]\d{6,7}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , phoneall:
                    function( _item ){
                        var _r = /^(?:\+[\d]{1,6}(?: |\-)|)(?:0[\d]{2,3}(?:\-| |)|)[1-9][\d]{6,7}(?:(?: |)\#[\d]{1,6}|)$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , phonezone: 
                    function( _item ){
                        var _r = /^[0-9]{3,4}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , phonecode: 
                    function( _item ){
                        var _r =  /^[0-9]{7,8}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }
                
                , phoneext: 
                    function( _item ){
                        var _r =  /^[0-9]{1,6}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , &#x27;length&#x27;: 
                    function( _item ){
                        var _r = true, _dt = _logic.getDatatype( _item ), _min, _max, _val = _item.val(), _len;

                        if( _item.is( &#x27;[minlength]&#x27; ) ){
                            UXC.log( &#x27;minlength&#x27; );
                            _min = parseInt( _item.attr( &#x27;minlength&#x27; ), 10 ) || 0;
                        }
                        
                        if( _item.is( &#x27;[maxlength]&#x27; ) ){
                            UXC.log( &#x27;maxlength&#x27; );
                            _max = parseInt( _item.attr( &#x27;maxlength&#x27; ), 10 ) || 0;
                        }
                        /**
                         * 根据特殊的 datatype 实现不同的计算方法
                         */
                        switch( _dt ){
                            case &#x27;richtext&#x27;:
                            case &#x27;bytetext&#x27;:
                                {
                                    _len = _logic.bytelen( _val );
                                    break;
                                }
                            default:
                                {
                                    _len = _val.length;
                                    break;
                                }
                        }

                        _min &amp;&amp; ( _len &lt; _min ) &amp;&amp; ( _r = false );
                        _max &amp;&amp; ( _len &gt; _max ) &amp;&amp; ( _r = false );

                        UXC.log( &#x27;lengthValid: &#x27;, _min, _max, _r );

                        !_r &amp;&amp; _logic.error( _item );

                        return _r;
                    }
                
                , reqmsg: 
                    function( _item ){
                        var _r;
                        if( _item.val() &amp;&amp; _item.val().constructor == Array ){
                            _r = !!( ( _item.val().join(&#x27;&#x27;) + &#x27;&#x27; ).trim() );
                        }else{
                            _r = !!( ( _item.val() ||&#x27;&#x27;).trim() );
                        }

                        !_r &amp;&amp; _logic.error( _item, &#x27;reqmsg&#x27; );
                        UXC.log( &#x27;regmsgValid: &#x27; + _r );
                        return _r;
                    }

                , reg: 
                    function( _item ){
                        var _r = true, _pattern;
                        if( _item.is( &#x27;[reg-pattern]&#x27; ) ) _pattern = _item.attr( &#x27;reg-pattern&#x27; );
                        if( !_pattern ) _pattern = _item.attr(&#x27;datatype&#x27;).trim().replace(/^reg(?:\-|)/i, &#x27;&#x27;);

                        _pattern.replace( /^\/([\s\S]*)\/([\w]{0,3})$/, function( $0, $1, $2 ){
                            UXC.log( $1, $2 );
                            _r = new RegExp( $1, $2 || &#x27;&#x27; ).test( _item.val() );
                        });

                        !_r &amp;&amp; _logic.error( _item );

                        return _r;
                    }

                , vcode:
                    function( _item ){
                        var _r, _len = parseInt( _item.attr(&#x27;datatype&#x27;).trim().replace( /^vcode(?:\-|)/i, &#x27;&#x27; ), 10 ) || 4; 
                        UXC.log( &#x27;vcodeValid: &#x27; + _len );
                        _r = new RegExp( &#x27;^[0-9a-zA-Z]{&#x27;+_len+&#x27;}$&#x27; ).test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , text: function(_item){ return true; }
                , bytetext: function(_item){ return true; }
                , richtext: function(_item){ return true; }
               
                , url: 
                    function( _item ){
                        var _r = /^((http|ftp|https):\/\/|)[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;amp;:\/~+#-]*[\w@?^=%&amp;amp;\/~+#-])$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , email: 
                    function( _item ){
                        var _r = /^[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , zipcode: 
                    function( _item ){
                        var _r = /^[0-9]{6}$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }

                , domain:
                    function( _item ){
                        var _r = /^(?:(?:f|ht)tp\:\/\/|)((?:(?:(?:\w[\.\-\+]?)*)\w)*)((?:(?:(?:\w[\.\-\+]?){0,62})\w)+)\.(\w{2,6})(?:\/|)$/.test( _item.val() );
                        !_r &amp;&amp; _logic.error( _item );
                        return _r;
                    }
            }//datatype
        };//_logic

}(jQuery))

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
