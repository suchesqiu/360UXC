(function(g){!window.UXC&&(window.UXC={log:function(){}});window.Panel=UXC.Panel=h;function h(b,d,c,a){this._model=new j(b,d,c,a);this._view=new f(this._model);this._init()}g(document).delegate("div.UPanel","click",function(b){var d=g(this),c=g(b.target||b.srcElement),a;if(c&&c.length&&c.is("[eventtype]")){a=c.attr("eventtype");UXC.log(a,d.data("PanelInstace"));a&&d.data("PanelInstace")&&d.data("PanelInstace").trigger(a,c,b)}});h.prototype={_init:function(){var a=this;this._view.getPanel().data("PanelInstace",this);this._model.addEvent("close_default",function(b,c){c._view.close()});this._model.addEvent("show_default",function(b,c){c._view.show()});this._model.addEvent("hide_default",function(b,c){c._view.hide()});this._model.addEvent("confirm_default",function(b,c){c.trigger("close")});this._model.addEvent("cancel_default",function(b,c){c.trigger("close")});return this},on:function(a,b){a&&b&&this._model.addEvent(a,b)},show:function(a){var b=this;setTimeout(function(){if(a!=undefined){switch(a){case 0:b.center();break}}},50);this.trigger("beforeshow",this._view.getPanel());this.trigger("show",this._view.getPanel())},hide:function(){this.trigger("beforehide",this._view.getPanel());this.trigger("hide",this._view.getPanel())},close:function(){UXC.log("Panel.close");this.trigger("beforeclose",this._view.getPanel());this.trigger("close",this._view.getPanel())},center:function(){this.trigger("beforecenter",this._view.getPanel());this._view.center();this.trigger("center",this._view.getPanel())},selector:function(){return this._view.getPanel()},trigger:function(b,d){UXC.log("Panel.trigger",b);var e=this,l=this._model.getEvent(b),c=true;if(l&&l.length){d&&(d=g(d))&&d.length&&(d=d[0]);g.each(l,function(n,k){if(k.call(d,b,e)===false){return c=false}})}if(c){var a=this._model.getEvent(b+"_default");if(a&&a.length){g.each(a,function(n,k){if(k.call(d,b,e)===false){return false}})}}},header:function(a){if(typeof a!="undefined"){this._view.getHeader(a)}var b=this._view.getHeader();if(b&&b.length){a=b.html()}return a||""},body:function(a){if(typeof a!="undefined"){this._view.getBody(a)}var b=this._view.getBody();if(b&&b.length){a=b.html()}return a||""},footer:function(a){if(typeof a!="undefined"){this._view.getFooter(a)}var b=this._view.getFooter();if(b&&b.length){a=b.html()}return a||""},panel:function(a){if(typeof a!="undefined"){this._view.getPanel(a)}var b=this._view.getPanel();if(b&&b.length){a=b.html()}return a||""}};function j(b,d,c,a){this.selector=b;this.headers=d;this.bodys=c;this.footers=a;this.panel;this._events={};this._init()}j.prototype={_init:function(){var a=typeof this.selector!="undefined"?g(this.selector):undefined;if(a&&a.length){this.selector=a;UXC.log("user tpl",this.selector.parent().length);if(!this.selector.parent().length){this.selector.appendTo(g(document.body))}}else{if(!a||a.length===0){this.footers=this.bodys;this.bodys=this.headers;this.headers=this.selector;this.selector=undefined}}return this},addEvent:function(a,b){if(!(a&&b)){return}a&&(a=a.toLowerCase());if(!(a in this._events)){this._events[a]=[]}if(/\_default/i.test(a)){this._events[a].unshift(b)}else{this._events[a].push(b)}},getEvent:function(a){return this._events[a]}};function f(a){this._model=a;this._tpl=i;this._init()}f.prototype={_init:function(){if(!this._model.panel){if(this._model.selector){this._model.panel=this._model.selector}else{this._model.panel=g(this._tpl);this._model.panel.hide().appendTo(document.body)}}this.getHeader();this.getBody();this.getFooter();return this},show:function(){this.getPanel().show()},hide:function(){this.getPanel().hide()},close:function(){UXC.log("Panel._view.close()");this.getPanel().remove()},getPanel:function(a){if(typeof a!="undefined"){this.getPanel().html(a)}return this._model.panel},getHeader:function(b){var a=this.getPanel().find("div.UPContent > div.hd");if(typeof b!="undefined"){this._model.headers=b}if(typeof this._model.headers!="undefined"){if(!a.length){this.getPanel().find("div.UPContent > div.bd").before(a=g('<div class="hd">弹出框</div>'))}a.html(this._model.headers);this._model.headers=undefined}return a},getBody:function(b){var a=this.getPanel().find("div.UPContent > div.bd");if(typeof b!="undefined"){this._model.bodys=b}if(typeof this._model.bodys!="undefined"){a.html(this._model.bodys);this._model.bodys=undefined}return a},getFooter:function(b){var a=this.getPanel().find("div.UPContent > div.ft");if(typeof b!="undefined"){this._model.footers=b}if(typeof this._model.footers!="undefined"){if(!a.length){this.getPanel().find("div.UPContent > div.bd").after(a=g('<div class="ft" ></div>'))}a.html(this._model.footers);this._model.footers=undefined}return a},center:function(){var a=this.getPanel(),b=a.width(),p=a.height(),d,o,r=g(window).width(),e=g(window).height(),c=g(document).scrollLeft(),q=g(document).scrollTop();a.css({left:"-9999px",top:"-9999px"}).show();d=(r-b)/2+c;o=(e-p)/2+q;if((e-p-100)>300){o-=100}UXC.log((e-p/2-100));if((o+p-q)>e){UXC.log("y overflow");o=q+e-p}if(o<q||o<0){o=q}a.css({left:d+"px",top:o+"px"});UXC.log(b,p,r,e)}};var i=['<div class="UPanel" style="width: 600px;">\n','    <div class="UPContent">\n','        <div class="bd"></div>\n','        <span class="close" eventtype="close"></span>\n',"    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join("")}(jQuery));(function(d){UXC.alert=function(g,h,a,b){return c.popup(c.tpls.alert,g,h,a,b)};UXC.confirm=function(g,h,a,b){return c.popup(c.tpls.confirm,g,h,a,b)};d(document).on("click",function(o){var b=d(o.target||o.srcElement),m=b.attr("paneltype"),p=b.attr("panelmsg");if(!(m&&p)){return}m=m.toLowerCase();b.prop("nodeName")&&b.prop("nodeName").toLowerCase()=="a"&&o.preventDefault();var a=(parseInt(b.attr("panelstatus"),10)||0),k=b.attr("panelcallback"),n=b.attr("panelcancelcallback");k&&(k=window[k]);n&&(n=window[n]);if(!(m in UXC)){return}var l=UXC[m](p,b,a);if(k){l.on("confirm",k)}if(n){l.on("cancel",n)}});d(window).on("resize",function(a){d("body > div.UPanelPopup_identifer").each(function(){var b=d(this);b.data("PopupInstance")&&c.onresize(b.data("PopupInstance"))})});var c={minWidth:180,maxWidth:500,xoffset:9,yoffset:3,popupIdentifier:function(a){if(!a){d("body > div.UPanelPopup_identifer").remove()}else{a.selector().addClass("UPanelPopup_identifer");a.selector().data("PopupInstance",a)}},popup:function(i,j,l,a,b){if(!j){return}c.popupIdentifier();l&&(l=d(l));var i=i.replace(/\{msg\}/g,j).replace(/\{status\}/g,c.getStatusClass(a||""));var k=new UXC.Panel(i);c.popupIdentifier(k);k.selector().data("popupSrc",l);c.fixWidth(j,k);b&&k.on("confirm",b);if(!l){k.center()}k.on("show_default",function(){UXC.log("user show_default");c.showEffect(k,l,function(){});return false});k.on("close_default",function(){UXC.log("user close_default");c.hideEffect(k,l,function(){k.selector().remove();k=null});return false});k.on("hide_default",function(){UXC.log("user hide_default");c.hideEffect(k,l,function(){k.selector().hide()});return false});if(l&&l.length){k.selector().css({left:"-9999px",top:"-9999px"})}k.show();return k},hideEffect:function(a,s,t){s&&(s=d(s));if(!(s&&s.length)){return}var m=s.offset(),r=a.selector();var p=r[0];p.interval&&clearInterval(p.interval);p.defaultWidth&&r.width(p.defaultWidth);p.defaultHeight&&r.height(p.defaultHeight);var q=s.width(),b=r.height();p.defaultWidth=r.width();p.defaultHeight=r.height();var n=c.getLeft(m.left,q,r.width());var o=c.getTop(m.top,s.height(),b);o=o-b-c.yoffset;r.height(0);r.css({left:n+"px"});p.interval=c.easyEffect(function(e){r.css({top:o+e+"px",height:b-e+"px"});if(b===e){r.hide()}},b)},showEffect:function(q,p){p&&(p=d(p));if(!(p&&p.length)){return}var a=p.offset(),o=q.selector();var m=o[0];m.interval&&clearInterval(m.interval);m.defaultWidth&&o.width(m.defaultWidth);m.defaultHeight&&o.height(m.defaultHeight);var n=p.width(),r=o.height();m.defaultWidth=o.width();m.defaultHeight=o.height();var b=c.getLeft(a.left,n,o.width());var l=c.getTop(a.top,p.height(),r,c.xoffset);o.height(0);o.css({left:b+"px"});UXC.log(l,a.top);if(l>a.top){m.interval=c.easyEffect(function(e){o.css({top:l-r-c.yoffset+"px",height:e+"px"})},r)}else{m.interval=c.easyEffect(function(e){o.css({top:l-e-c.yoffset+"px",height:e+"px"})},r)}},onresize:function(z){if(!z.selector().is(":visible")){return}var w=z.selector(),y=w.data("popupSrc");if(!(y&&y.length)){z.center()}else{var t=y.offset();var a=t.top,v=y.height(),q=w.height(),A=0,x=t.left,s=y.width(),b=w.width(),r=0;var u=c.getLeft(x,s,b,r)+c.xoffset;var B=c.getTop(a,v,q,A)-q-c.yoffset;w.css({left:u+"px",top:B+"px"})}},getTop:function(m,j,a,k){var l=m,b=d(document).scrollTop(),n=d(window).height()-a;l-a<b&&(l=m+j+a+k);return l},getLeft:function(b,j,k,l){l==undefined&&(l=5);var m=b+j/2+l-k/2,n=d(document).scrollLeft(),a=d(window).width()-k;m>a&&(m=a-2);m<n&&(m=n+1);return m},fixWidth:function(g,h){var a=d('<div style="position:absolute; left:-9999px;top:-9999px;">'+g+"</div>").appendTo("body"),b=a.width()+80;a.remove();b>c.maxWidth&&(b=c.maxWidth);b<c.minWidth&&(b=c.minWidth);h.selector().css("width",b)},getStatusClass:function(b){var a="UPanelSuccess";switch(b){case 0:a="UPanelSuccess";break;case 1:a="UPanelError";break;case 2:a="UPanelAlert";break}return a},easyEffect:function(m,a,o,n,p){var l=new Date(),k,a=a||200,o=o||0,n=n||200,p=p||2;var b=setInterval(function(){k=new Date()-l;o=k/n*a;if(o>a){o=a;clearInterval(b)}m&&m(o)},p);return b},tpls:{alert:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join(""),confirm:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>','                    <button type="button" eventtype="cancel">取消</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join("")}}}(jQuery));(function(g){window.ZIDNEX_COUNT=window.ZINDEX_COUNT||50001;var e=!!window.ActiveXObject&&!window.XMLHttpRequest;var h=window.Dialog=UXC.Dialog=function(c,j,d,a){if(f.timeout){clearTimeout(f.timeout)}f.dialogIdentifier();var b=new UXC.Panel(c,j,d,a);f.dialogIdentifier(b);f.showMask();b.selector().css("z-index",window.ZINDEX_COUNT++);b.on("close_default",function(l,i){f.hideMask()});f.timeout=setTimeout(function(){b.show(0)},f.showMs);return b};UXC.Dialog.alert=function(d,j,a){if(!d){return}var b=f.tpls.alert.replace(/\{msg\}/g,d).replace(/\{status\}/g,f.getStatusClass(j||""));var c=UXC.Dialog(b);f.fixWidth(d,c);a&&c.on("confirm",a);return c};UXC.Dialog.confirm=function(d,j,a){if(!d){return}var b=f.tpls.confirm.replace(/\{msg\}/g,d).replace(/\{status\}/g,f.getStatusClass(j||""));var c=UXC.Dialog(b);f.fixWidth(d,c);a&&c.on("confirm",a);return c};g(document).on("click",function(o){var c=g(o.target||o.srcElement),d=c.attr("paneltype"),p=c.attr("panelmsg");if(!(d&&p)){return}d=d.toLowerCase();if(!/dialog\./.test(d)){return}d=d.replace(/.*?\./,"");c.prop("nodeName")&&c.prop("nodeName").toLowerCase()=="a"&&o.preventDefault();var a=(parseInt(c.attr("panelstatus"),10)||0),m=c.attr("panelcallback"),n=c.attr("panelcancelcallback");m&&(m=window[m]);n&&(n=window[n]);if(!(d in UXC.Dialog)){return}var b=UXC.Dialog[d](p,a);if(m){b.on("confirm",m)}if(n){b.on("cancel",n)}});g(window).on("resize scroll",function(a){g("body > div.UPanelDialog_identifer").each(function(){var b=g(this);if(b.data("DialogInstance")){if(!b.data("DialogInstance").selector().is(":visible")){return}if(a.type.toLowerCase()=="resize"){b.data("DialogInstance").center()}f.setMaskSizeForIe6()}})});var f={timeout:null,showMs:10,minWidth:180,maxWidth:500,dialogIdentifier:function(a){if(!a){f.hideMask();g("body > div.UPanelDialog_identifer").remove()}else{a.selector().addClass("UPanelDialog_identifer");a.selector().data("DialogInstance",a)}},showMask:function(){var a=g("#UPanelMask"),b=g("#UPanelMaskIfrmae");if(!a.length){g(f.tpls.mask).appendTo("body");a=g("#UPanelMask"),b=g("#UPanelMaskIfrmae")}b.show();a.show();f.setMaskSizeForIe6();b.css("z-index",window.ZINDEX_COUNT++);a.css("z-index",window.ZINDEX_COUNT++)},hideMask:function(){var a=g("#UPanelMask"),b=g("#UPanelMaskIfrmae");if(a.length){a.hide()}if(b.length){b.hide()}},setMaskSizeForIe6:function(){var b=g("#UPanelMask"),c=g("#UPanelMaskIfrmae");if(!(b.length&&c.length)){return}var a={position:"absolute",top:"0px",left:g(document).scrollLeft()+"px",height:g(document).height()+"px",width:g(window).width()+"px"};b.css(a);c.css(a)},getStatusClass:function(b){var a="UPanelSuccess";switch(b){case 0:a="UPanelSuccess";break;case 1:a="UPanelError";break;case 2:a="UPanelAlert";break}return a},fixWidth:function(c,d){var a=g('<div style="position:absolute; left:-9999px;top:-9999px;">'+c+"</div>").appendTo("body"),b=a.width()+80;b>f.maxWidth&&(b=f.maxWidth);b<f.minWidth&&(b=f.minWidth);d.selector().css("width",b)},tpls:{alert:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join(""),confirm:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>','                    <button type="button" eventtype="cancel">取消</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join(""),mask:['<div id="UPanelMask" class="UPanelMask"></div>','<iframe src="about:blank" id="UPanelMaskIfrmae"',' frameborder="0" class="UPanelMaskIframe"></iframe>'].join("")}}}(jQuery));