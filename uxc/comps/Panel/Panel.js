(function(j){!window.UXC&&(window.UXC={log:function(){}});window.Panel=UXC.Panel=f;function f(d,b,a,c){this._model=new h(d,b,a,c);this._view=new i(this._model);this._init()}j(document).delegate("div.UPanel","click",function(d){var b=j(this),a=j(d.target||d.srcElement),c;if(a&&a.length&&a.is("[eventtype]")){c=a.attr("eventtype");UXC.log(c,b.data("PanelInstace"));c&&b.data("PanelInstace")&&b.data("PanelInstace").trigger(c,a,d)}});f.prototype={_init:function(){var a=this;this._view.getPanel().data("PanelInstace",this);this._model.addEvent("close_default",function(c,b){b._view.close()});this._model.addEvent("show_default",function(c,b){b._view.show()});this._model.addEvent("hide_default",function(c,b){b._view.hide()});this._model.addEvent("confirm_default",function(c,b){b.trigger("close")});this._model.addEvent("cancel_default",function(c,b){b.trigger("close")});return this},on:function(a,b){a&&b&&this._model.addEvent(a,b)},show:function(a){var b=this;setTimeout(function(){if(a!=undefined){switch(a){case 0:b.center();break}}},50);this.trigger("beforeshow",this._view.getPanel());this.trigger("show",this._view.getPanel())},hide:function(){this.trigger("beforehide",this._view.getPanel());this.trigger("hide",this._view.getPanel())},close:function(){UXC.log("Panel.close");this.trigger("beforeclose",this._view.getPanel());this.trigger("close",this._view.getPanel())},center:function(){this.trigger("beforecenter",this._view.getPanel());this._view.center();this.trigger("center",this._view.getPanel())},selector:function(){return this._view.getPanel()},trigger:function(d,a){UXC.log("Panel.trigger",d);var l=this,b=this._model.getEvent(d),e=true;if(b&&b.length){a&&(a=j(a))&&a.length&&(a=a[0]);j.each(b,function(k,n){if(n.call(a,d,l)===false){return e=false}})}if(e){var c=this._model.getEvent(d+"_default");if(c&&c.length){j.each(c,function(k,n){if(n.call(a,d,l)===false){return false}})}}},header:function(a){if(typeof a!="undefined"){this._view.getHeader(a)}var b=this._view.getHeader();if(b&&b.length){a=b.html()}return a||""},body:function(a){if(typeof a!="undefined"){this._view.getBody(a)}var b=this._view.getBody();if(b&&b.length){a=b.html()}return a||""},footer:function(a){if(typeof a!="undefined"){this._view.getFooter(a)}var b=this._view.getFooter();if(b&&b.length){a=b.html()}return a||""},panel:function(a){if(typeof a!="undefined"){this._view.getPanel(a)}var b=this._view.getPanel();if(b&&b.length){a=b.html()}return a||""}};function h(d,b,a,c){this.selector=d;this.headers=b;this.bodys=a;this.footers=c;this.panel;this._events={};this._init()}h.prototype={_init:function(){var a=typeof this.selector!="undefined"?j(this.selector):undefined;if(a&&a.length){this.selector=a;UXC.log("user tpl",this.selector.parent().length);if(!this.selector.parent().length){this.selector.appendTo(j(document.body))}}else{if(!a||a.length===0){this.footers=this.bodys;this.bodys=this.headers;this.headers=this.selector;this.selector=undefined}}return this},addEvent:function(a,b){if(!(a&&b)){return}a&&(a=a.toLowerCase());if(!(a in this._events)){this._events[a]=[]}if(/\_default/i.test(a)){this._events[a].unshift(b)}else{this._events[a].push(b)}},getEvent:function(a){return this._events[a]}};function i(a){this._model=a;this._tpl=g;this._init()}i.prototype={_init:function(){if(!this._model.panel){if(this._model.selector){this._model.panel=this._model.selector}else{this._model.panel=j(this._tpl);this._model.panel.hide().appendTo(document.body)}}this.getHeader();this.getBody();this.getFooter();return this},show:function(){this.getPanel().show()},hide:function(){this.getPanel().hide()},close:function(){UXC.log("Panel._view.close()");this.getPanel().remove()},getPanel:function(a){if(typeof a!="undefined"){this.getPanel().html(a)}return this._model.panel},getHeader:function(b){var a=this.getPanel().find("div.UPContent > div.hd");if(typeof b!="undefined"){this._model.headers=b}if(typeof this._model.headers!="undefined"){if(!a.length){this.getPanel().find("div.UPContent > div.bd").before(a=j('<div class="hd">弹出框</div>'))}a.html(this._model.headers);this._model.headers=undefined}return a},getBody:function(b){var a=this.getPanel().find("div.UPContent > div.bd");if(typeof b!="undefined"){this._model.bodys=b}if(typeof this._model.bodys!="undefined"){a.html(this._model.bodys);this._model.bodys=undefined}return a},getFooter:function(b){var a=this.getPanel().find("div.UPContent > div.ft");if(typeof b!="undefined"){this._model.footers=b}if(typeof this._model.footers!="undefined"){if(!a.length){this.getPanel().find("div.UPContent > div.bd").after(a=j('<div class="ft" ></div>'))}a.html(this._model.footers);this._model.footers=undefined}return a},center:function(){var a=this.getPanel(),b=a.width(),p=a.height(),d,o,r=j(window).width(),e=j(window).height(),c=j(document).scrollLeft(),q=j(document).scrollTop();a.css({left:"-9999px",top:"-9999px"}).show();d=(r-b)/2+c;o=(e-p)/2+q;if((e-p-100)>300){o-=100}UXC.log((e-p/2-100));if((o+p-q)>e){UXC.log("y overflow");o=q+e-p}if(o<q||o<0){o=q}a.css({left:d+"px",top:o+"px"});UXC.log(b,p,r,e)}};var g=['<div class="UPanel" style="width: 600px;">\n','    <div class="UPContent">\n','        <div class="bd"></div>\n','        <span class="close" eventtype="close"></span>\n',"    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join("")}(jQuery));(function(d){UXC.alert=function(a,b,g,h){return c.popup(c.tpls.alert,a,b,g,h)};UXC.confirm=function(a,b,g,h){return c.popup(c.tpls.confirm,a,b,g,h)};d(document).on("click",function(m){var o=d(m.target||m.srcElement),l=o.attr("paneltype"),b=o.attr("panelmsg");if(!(l&&b)){return}l=l.toLowerCase();o.prop("nodeName")&&o.prop("nodeName").toLowerCase()=="a"&&m.preventDefault();var n=(parseInt(o.attr("panelstatus"),10)||0),p=o.attr("panelcallback"),a=o.attr("panelcancelcallback");p&&(p=window[p]);a&&(a=window[a]);if(!(l in UXC)){return}var k=UXC[l](b,o,n);if(p){k.on("confirm",p)}if(a){k.on("cancel",a)}});d(window).on("resize",function(a){d("body > div.UPanelPopup_identifer").each(function(){var b=d(this);b.data("PopupInstance")&&c.onresize(b.data("PopupInstance"))})});var c={minWidth:180,maxWidth:500,xoffset:9,yoffset:3,popupIdentifier:function(a){if(!a){d("body > div.UPanelPopup_identifer").remove()}else{a.selector().addClass("UPanelPopup_identifer");a.selector().data("PopupInstance",a)}},popup:function(k,a,b,i,j){if(!a){return}c.popupIdentifier();b&&(b=d(b));var k=k.replace(/\{msg\}/g,a).replace(/\{status\}/g,c.getStatusClass(i||""));var l=new UXC.Panel(k);c.popupIdentifier(l);l.selector().data("popupSrc",b);c.fixWidth(a,l);j&&l.on("confirm",j);if(!b){l.center()}l.on("show_default",function(){UXC.log("user show_default");c.showEffect(l,b,function(){});return false});l.on("close_default",function(){UXC.log("user close_default");c.hideEffect(l,b,function(){l.selector().remove();l=null});return false});l.on("hide_default",function(){UXC.log("user hide_default");c.hideEffect(l,b,function(){l.selector().hide()});return false});if(b&&b.length){l.selector().css({left:"-9999px",top:"-9999px"})}l.show();return l},hideEffect:function(s,q,r){q&&(q=d(q));if(!(q&&q.length)){return}var a=q.offset(),p=s.selector();var n=p[0];n.interval&&clearInterval(n.interval);n.defaultWidth&&p.width(n.defaultWidth);n.defaultHeight&&p.height(n.defaultHeight);var o=q.width(),t=p.height();n.defaultWidth=p.width();n.defaultHeight=p.height();var b=c.getLeft(a.left,o,p.width());var m=c.getTop(a.top,q.height(),t);m=m-t-c.yoffset;p.height(0);p.css({left:b+"px"});n.interval=c.easyEffect(function(e){p.css({top:m+e+"px",height:t-e+"px"});if(t===e){p.hide()}},t)},showEffect:function(q,p){p&&(p=d(p));if(!(p&&p.length)){return}var a=p.offset(),o=q.selector();var m=o[0];m.interval&&clearInterval(m.interval);m.defaultWidth&&o.width(m.defaultWidth);m.defaultHeight&&o.height(m.defaultHeight);var n=p.width(),r=o.height();m.defaultWidth=o.width();m.defaultHeight=o.height();var b=c.getLeft(a.left,n,o.width());var l=c.getTop(a.top,p.height(),r,c.xoffset);o.height(0);o.css({left:b+"px"});UXC.log(l,a.top);if(l>a.top){m.interval=c.easyEffect(function(e){o.css({top:l-r-c.yoffset+"px",height:e+"px"})},r)}else{m.interval=c.easyEffect(function(e){o.css({top:l-e-c.yoffset+"px",height:e+"px"})},r)}},onresize:function(B){if(!B.selector().is(":visible")){return}var y=B.selector(),A=y.data("popupSrc");if(!(A&&A.length)){B.center()}else{var x=A.offset();var s=x.top,b=A.height(),u=y.height(),q=0,z=x.left,w=A.width(),t=y.width(),v=0;var a=c.getLeft(z,w,t,v)+c.xoffset;var r=c.getTop(s,b,u,q)-u-c.yoffset;y.css({left:a+"px",top:r+"px"})}},getTop:function(b,k,n,l){var a=b,j=d(document).scrollTop(),m=d(window).height()-n;a-n<j&&(a=b+k+n+l);return a},getLeft:function(j,k,a,l){l==undefined&&(l=5);var b=j+k/2+l-a/2,m=d(document).scrollLeft(),n=d(window).width()-a;b>n&&(b=n-2);b<m&&(b=m+1);return b},fixWidth:function(a,b){var g=d('<div style="position:absolute; left:-9999px;top:-9999px;">'+a+"</div>").appendTo("body"),h=g.width()+80;g.remove();h>c.maxWidth&&(h=c.maxWidth);h<c.minWidth&&(h=c.minWidth);b.selector().css("width",h)},getStatusClass:function(b){var a="UPanelSuccess";switch(b){case 0:a="UPanelSuccess";break;case 1:a="UPanelError";break;case 2:a="UPanelAlert";break}return a},easyEffect:function(l,n,m,a,b){var k=new Date(),p,n=n||200,m=m||0,a=a||200,b=b||2;var o=setInterval(function(){p=new Date()-k;m=p/a*n;if(m>n){m=n;clearInterval(o)}l&&l(m)},b);return o},tpls:{alert:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join(""),confirm:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>','                    <button type="button" eventtype="cancel">取消</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join("")}}}(jQuery));(function(e){window.ZIDNEX_COUNT=window.ZINDEX_COUNT||50001;var g=!!window.ActiveXObject&&!window.XMLHttpRequest;var f=window.Dialog=UXC.Dialog=function(j,b,a,c){if(h.timeout){clearTimeout(h.timeout)}h.dialogIdentifier();var d=new UXC.Panel(j,b,a,c);h.dialogIdentifier(d);h.showMask();d.selector().css("z-index",window.ZINDEX_COUNT++);d.on("close_default",function(l,i){h.hideMask()});h.timeout=setTimeout(function(){d.show(0)},h.showMs);return d};UXC.Dialog.alert=function(a,b,c){if(!a){return}var d=h.tpls.alert.replace(/\{msg\}/g,a).replace(/\{status\}/g,h.getStatusClass(b||""));var j=UXC.Dialog(d);h.fixWidth(a,j);c&&j.on("confirm",c);return j};UXC.Dialog.confirm=function(a,b,c){if(!a){return}var d=h.tpls.confirm.replace(/\{msg\}/g,a).replace(/\{status\}/g,h.getStatusClass(b||""));var j=UXC.Dialog(d);h.fixWidth(a,j);c&&j.on("confirm",c);return j};e(document).on("click",function(m){var o=e(m.target||m.srcElement),d=o.attr("paneltype"),b=o.attr("panelmsg");if(!(d&&b)){return}d=d.toLowerCase();if(!/dialog\./.test(d)){return}d=d.replace(/.*?\./,"");o.prop("nodeName")&&o.prop("nodeName").toLowerCase()=="a"&&m.preventDefault();var n=(parseInt(o.attr("panelstatus"),10)||0),p=o.attr("panelcallback"),a=o.attr("panelcancelcallback");p&&(p=window[p]);a&&(a=window[a]);if(!(d in UXC.Dialog)){return}var c=UXC.Dialog[d](b,n);if(p){c.on("confirm",p)}if(a){c.on("cancel",a)}});e(window).on("resize scroll",function(a){e("body > div.UPanelDialog_identifer").each(function(){var b=e(this);if(b.data("DialogInstance")){if(!b.data("DialogInstance").selector().is(":visible")){return}if(a.type.toLowerCase()=="resize"){b.data("DialogInstance").center()}h.setMaskSizeForIe6()}})});var h={timeout:null,showMs:10,minWidth:180,maxWidth:500,dialogIdentifier:function(a){if(!a){h.hideMask();e("body > div.UPanelDialog_identifer").remove()}else{a.selector().addClass("UPanelDialog_identifer");a.selector().data("DialogInstance",a)}},showMask:function(){var a=e("#UPanelMask"),b=e("#UPanelMaskIfrmae");if(!a.length){e(h.tpls.mask).appendTo("body");a=e("#UPanelMask"),b=e("#UPanelMaskIfrmae")}b.show();a.show();h.setMaskSizeForIe6();b.css("z-index",window.ZINDEX_COUNT++);a.css("z-index",window.ZINDEX_COUNT++)},hideMask:function(){var a=e("#UPanelMask"),b=e("#UPanelMaskIfrmae");if(a.length){a.hide()}if(b.length){b.hide()}},setMaskSizeForIe6:function(){var a=e("#UPanelMask"),b=e("#UPanelMaskIfrmae");if(!(a.length&&b.length)){return}var c={position:"absolute",top:"0px",left:e(document).scrollLeft()+"px",height:e(document).height()+"px",width:e(window).width()+"px"};a.css(c);b.css(c)},getStatusClass:function(b){var a="UPanelSuccess";switch(b){case 0:a="UPanelSuccess";break;case 1:a="UPanelError";break;case 2:a="UPanelAlert";break}return a},fixWidth:function(a,b){var c=e('<div style="position:absolute; left:-9999px;top:-9999px;">'+a+"</div>").appendTo("body"),d=c.width()+80;d>h.maxWidth&&(d=h.maxWidth);d<h.minWidth&&(d=h.minWidth);b.selector().css("width",d)},tpls:{alert:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join(""),confirm:['<div class="UPanel UPanelPopup {status}" >\n','    <div class="UPContent">\n','        <div class="bd">\n',"            <dl>\n",'                <dd class="UPopupContent">\n','                <button class="UIcon" align="absMiddle" ></button><div class="UText"><button type="button" class="UPlaceholder"></button>{msg}</div>\n',"                </dd>\n",'                <dd class="UButton">\n','                    <button type="button" eventtype="confirm">确定</button>','                    <button type="button" eventtype="cancel">取消</button>\n',"                </dd>\n","            </dl>\n","        </div>\n","    </div><!--end UPContent-->\n","</div><!--end UPanel-->\n"].join(""),mask:['<div id="UPanelMask" class="UPanelMask"></div>','<iframe src="about:blank" id="UPanelMaskIfrmae"',' frameborder="0" class="UPanelMaskIframe"></iframe>'].join("")}}}(jQuery));